import{_ as e}from"./lodash-2VbGH-WW.js";import{d as t}from"./department-api-Dth9G_6l.js";import{d as a}from"./department-mitt-DFEu9DtT.js";import{d as r,r as l,e as s,w as o,l as n,b2 as i,ag as d,o as p,bz as u,c,b as m,u as v,aR as h,ai as f,be as y}from"./@vue-BVvo-xZd.js";import{a as j}from"./index-CBkxY9s9.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./mitt-CNZ6avp8.js";import"./ant-design-vue-CcohkicM.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./dayjs-B6vKC6dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";const I={key:1,class:"no-data"},b=j(r({__name:"index",props:{checkable:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!1},height:Number,showMenu:{type:Boolean,default:!1}},setup(r,{expose:j}){const b=r,k=l(),g=l([]),x=l([]),w=l(new Map);async function E(){let a=(await t.queryAllDepartment()).data;g.value=a,x.value=K(a,0),a.forEach((e=>{w.value.set(e.departmentId,e)})),!e.isEmpty(x.value)&&x.value.length>0&&(k.value=x.value[0].departmentId),B(x.value[0].departmentId)}function K(e,t){let a=e.filter((e=>e.parentId===t))||[];return a.forEach((t=>{t.children=K(e,t.departmentId)})),function(e){for(let t=0;t<e.length;t++)0!==t?t!==e.length-1?(e[t].preId=e[t-1].departmentId,e[t].nextId=e[t+1].departmentId):(e[t].preId=e[t-1].departmentId,e[t].nextId=void 0):e[t].nextId=e.length>1?e[1].departmentId:void 0}(a),a}s((()=>{E()}));const _=l([]),D=l([]),S=l([]);l();const z=l([]);function B(e){_.value=[e],M(_.value)}function M(t){if(e.isEmpty(t))return S.value=[],void(z.value=[]);let a=t[0];z.value=g.value.filter((e=>e.parentId==a));let r=[];q(r,a,!0),S.value=r.map((e=>e.name))}a.on("selectTree",B);const U=l("");function q(e,t,a){let r=w.value.get(t);r&&!e.some((e=>e.departmentId==t))&&(a?e.unshift(r):e.push(r),r.parentId&&0!=r.parentId&&q(e,r.parentId,a))}return o((()=>U.value),(()=>{!function(){if(!U.value)return void(x.value=K(g.value,0));let e=g.value.concat();if(!e)return;let t=e.filter((e=>e.name.indexOf(U.value)>-1)),a=[];t.forEach((e=>{q(a,e.departmentId,!1)})),x.value=K(a,0)}()})),n((()=>{a.all.clear()})),j({queryDepartmentTree:E,selectedDepartmentChildren:z,breadcrumb:S,selectedKeys:_,checkedKeys:D,keywords:U}),(t,a)=>{const l=i("a-input"),s=i("a-row"),o=i("a-tree"),n=i("a-card");return p(),d(n,{class:"tree-container"},{default:u((()=>[c(s,{class:"smart-margin-bottom10"},{default:u((()=>[c(l,{value:U.value,"onUpdate:value":a[0]||(a[0]=e=>U.value=e),valueModifiers:{trim:!0},placeholder:"请输入部门名称"},null,8,["value"])])),_:1}),v(e).isEmpty(x.value)?(p(),m("div",I,"暂无结果")):(p(),d(o,{key:0,selectedKeys:_.value,"onUpdate:selectedKeys":a[1]||(a[1]=e=>_.value=e),checkedKeys:D.value,"onUpdate:checkedKeys":a[2]||(a[2]=e=>D.value=e),class:"tree",treeData:x.value,fieldNames:{title:"name",key:"departmentId",value:"departmentId"},style:h([{width:"100%","overflow-x":"auto"},[r.height?{height:`${r.height}px`,overflowY:"auto"}:""]]),checkable:b.checkable,checkStrictly:b.checkStrictly,selectable:!b.checkable,defaultExpandAll:!0,onSelect:M},{title:u((e=>[f("div",null,y(e.name),1)])),_:1},8,["selectedKeys","checkedKeys","treeData","style","checkable","checkStrictly","selectable"]))])),_:1})}}}),[["__scopeId","data-v-b5903363"]]);export{b as default};
