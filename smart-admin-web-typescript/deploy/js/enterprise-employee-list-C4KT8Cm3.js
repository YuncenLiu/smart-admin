import{_ as e}from"./index.vue_vue_type_script_setup_true_lang-BqAwz9eM.js";import{_ as t}from"./lodash-2VbGH-WW.js";import{e as a}from"./enterprise-api-COduTEQq.js";import{c as s,d as i,P as o,S as r,s as l,a as n}from"./index-CBkxY9s9.js";import{M as p,b as d}from"./ant-design-vue-CcohkicM.js";import{d as u,a as c,r as m,m as y,w as g,b2 as v,z as j,b as f,o as w,ai as h,c as I,J as b,bz as _,y as x,ag as k,ah as z,be as E,u as S}from"./@vue-BVvo-xZd.js";import"./index.vue_vue_type_script_setup_true_lang-Ca0kUvG5.js";import"./department-api-Dth9G_6l.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const C={class:"header"},N={key:1},T=["onClick"],L={class:"smart-query-table-page"},P=n(u({__name:"enterprise-employee-list",props:{enterpriseId:{type:Number,default:null}},setup(n){const u=n,P=c([{title:"姓名",dataIndex:"actualName"},{title:"手机号",dataIndex:"phone",width:120},{title:"登录账号",dataIndex:"loginName"},{title:"企业",dataIndex:"enterpriseName",ellipsis:!0},{title:"部门",dataIndex:"departmentName",ellipsis:!0},{title:"状态",dataIndex:"disabledFlag",width:80},{title:"操作",dataIndex:"operate",width:60}]),U=c({...{pageNum:1,pageSize:s,enterpriseId:void 0,keyword:void 0}}),D=m(0),M=m([]),O=m(!1);function q(){U.keyword="",J()}function F(){U.pageNum=1,J()}async function J(){try{O.value=!0,U.enterpriseId=u.enterpriseId;let e=await a.queryPageEmployeeList(U);M.value=e.data.list,D.value=e.data.total}catch(e){l.captureError(e)}finally{O.value=!1}}async function K(e){if(t.isEmpty(e))d.warning("请选择员工");else{r.show();try{let t={employeeIdList:e,enterpriseId:u.enterpriseId};await a.addEmployee(t),d.success("添加成功"),await J()}catch(s){l.captureError(s)}finally{r.hide()}}}const R=m();async function B(){let e=(await a.employeeList([u.enterpriseId])).data.map((e=>e.employeeId))||[];R.value.showModal(e)}const G=m([]),Q=y((()=>G.value.length>0));function V(e){G.value=e}function W(){Q.value?p.confirm({title:"提示",content:"确定要删除该企业下的员工么？",okText:"确定",okType:"danger",async onOk(){r.show();try{let e={employeeIdList:G.value,enterpriseId:u.enterpriseId};await a.deleteEmployee(e),d.success("移除成功"),G.value=[],await J()}catch(e){l.captureError(e)}finally{r.hide()}},cancelText:"取消",onCancel(){}}):d.warning("请选择要删除的员工")}return g((()=>u.enterpriseId),(e=>{e&&J()}),{immediate:!0}),(t,s)=>{const n=v("a-input"),c=v("a-button"),m=v("a-tag"),y=v("a-table"),g=v("a-pagination"),Q=j("privilege");return w(),f("div",null,[h("div",C,[h("div",null,[b(" 关键字： "),I(n,{style:{width:"250px"},value:U.keyword,"onUpdate:value":s[0]||(s[0]=e=>U.keyword=e),placeholder:"姓名/手机号/登录账号"},null,8,["value"]),I(c,{class:"button-style",type:"primary",onClick:F},{default:_((()=>[b("搜索")])),_:1}),I(c,{class:"button-style",type:"default",onClick:q},{default:_((()=>[b("重置")])),_:1})]),h("div",null,[x((w(),k(c,{class:"button-style",type:"primary",onClick:B},{default:_((()=>[b(" 添加员工 ")])),_:1})),[[Q,"oa:enterprise:addEmployee"]]),x((w(),k(c,{class:"button-style",type:"primary",danger:"",onClick:W},{default:_((()=>[b(" 批量移除 ")])),_:1})),[[Q,"oa:enterprise:deleteEmployee"]])])]),I(y,{loading:O.value,dataSource:M.value,columns:P,pagination:!1,rowKey:"employeeId","row-selection":{selectedRowKeys:G.value,onChange:V},size:"small",bordered:""},{bodyCell:_((({text:e,record:s,index:i,column:o})=>["disabledFlag"===o.dataIndex?(w(),k(m,{key:0,color:e?"error":"processing"},{default:_((()=>[b(E(e?"禁用":"启用"),1)])),_:2},1032,["color"])):"gender"===o.dataIndex?(w(),f("span",N,E(t.$smartEnumPlugin.getDescByValue("GENDER_ENUM",e)),1)):z("",!0),"operate"===o.dataIndex?x((w(),f("a",{key:2,onClick:e=>async function(e){p.confirm({title:"提示",content:"确定要删除该企业下的员工么？",okText:"确定",okType:"danger",async onOk(){r.show();try{let t={employeeIdList:[e],enterpriseId:u.enterpriseId};await a.deleteEmployee(t),d.success("移除成功"),await J()}catch(t){l.captureError(t)}finally{r.hide()}},cancelText:"取消",onCancel(){}})}(s.employeeId)},[b("移除")],8,T)),[[Q,"oa:enterprise:deleteEmployee"]]):z("",!0)])),_:1},8,["loading","dataSource","columns","row-selection"]),h("div",L,[I(g,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:S(o),defaultPageSize:U.pageSize,current:U.pageNum,"onUpdate:current":s[1]||(s[1]=e=>U.pageNum=e),pageSize:U.pageSize,"onUpdate:pageSize":s[2]||(s[2]=e=>U.pageSize=e),total:D.value,onChange:J,onShowSizeChange:J,"show-total":S(i)},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),I(e,{ref_key:"selectEmployeeModal",ref:R,onSelectData:K},null,512)])}}}),[["__scopeId","data-v-4bab8632"]]);export{P as default};
