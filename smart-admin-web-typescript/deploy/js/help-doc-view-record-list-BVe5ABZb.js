import{c as e,P as t,v as a,s,a as o}from"./index-CBkxY9s9.js";import{u as r}from"./ua-parser-js-DNXwZhEt.js";import{d as i,r as l,a as n,b2 as p,b as d,o as u,c as m,ai as c,bz as f,J as j,ah as g,F as v,be as y,u as h}from"./@vue-BVvo-xZd.js";import"./ant-design-vue-CcohkicM.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./dayjs-B6vKC6dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-2VbGH-WW.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";const w={class:"smart-query-table-page"},b=o(i({__name:"help-doc-view-record-list",props:{helpDocId:{type:[Number,String]}},setup(o,{expose:i}){const b=o;i({onSearch:q});const S=[{title:"用户名",dataIndex:"userName"},{title:"查看次数",dataIndex:"pageViewCount",with:100},{title:"首次查看设备",dataIndex:"firstIp"},{title:"首次查看时间",dataIndex:"createTime",with:120},{title:"最后一次查看设备",dataIndex:"lastIp"},{title:"最后一次查看时间",dataIndex:"updateTime",with:120}],I=l([]),z=l(0),x=l(!1),_={helpDocId:b.helpDocId,keywords:"",pageNum:1,pageSize:e},k=n({..._});function C(e){if(!e)return"";let t=r(e);return t.browser.name+"/"+t.os.name+"/"+(t.device.vendor?t.device.vendor+t.device.model:"")}async function D(){try{x.value=!0;const e=await a.queryViewRecord(k);for(const t of e.data.list)t.firstDevice=C(t.firstUserAgent),t.lastDevice=C(t.lastUserAgent);I.value=e.data.list,z.value=e.data.total}catch(e){s.captureError(e)}finally{x.value=!1}}function q(){k.pageNum=1,D()}function N(){Object.assign(k,_),D()}return(e,a)=>{const s=p("a-input"),o=p("a-form-item"),r=p("SearchOutlined"),i=p("a-button"),l=p("ReloadOutlined"),n=p("a-button-group"),b=p("a-row"),_=p("a-form"),C=p("a-table"),O=p("a-pagination");return u(),d("div",null,[m(_,{class:"smart-query-form"},{default:f((()=>[m(b,{class:"smart-query-form-row"},{default:f((()=>[m(o,{label:"关键字",class:"smart-query-form-item",style:{width:"280px"}},{default:f((()=>[m(s,{value:k.keywords,"onUpdate:value":a[0]||(a[0]=e=>k.keywords=e),placeholder:"姓名/IP/设备"},null,8,["value"])])),_:1}),m(o,{class:"smart-query-form-item smart-margin-left10"},{default:f((()=>[m(n,null,{default:f((()=>[m(i,{type:"primary",onClick:q},{icon:f((()=>[m(r)])),default:f((()=>[j(" 查询 ")])),_:1}),m(i,{onClick:N},{icon:f((()=>[m(l)])),default:f((()=>[j(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),m(C,{rowKey:"employeeId",columns:S,dataSource:I.value,pagination:!1,loading:x.value,size:"small",bordered:""},{bodyCell:f((({column:e,record:t,text:a})=>["firstIp"===e.dataIndex?(u(),d(v,{key:0},[j(y(a)+" ("+y(t.firstDevice)+") ",1)],64)):g("",!0),"lastIp"===e.dataIndex?(u(),d(v,{key:1},[j(y(a)+" ("+y(t.lastDevice)+") ",1)],64)):g("",!0)])),_:1},8,["dataSource","loading"]),c("div",w,[m(O,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:h(t),defaultPageSize:k.pageSize,current:k.pageNum,"onUpdate:current":a[1]||(a[1]=e=>k.pageNum=e),pageSize:k.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>k.pageSize=e),total:z.value,onChange:D,onShowSizeChange:D,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])}}}),[["__scopeId","data-v-95522a72"]]);export{b as default};
