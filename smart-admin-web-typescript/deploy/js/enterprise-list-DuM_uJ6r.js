import{c as e,P as a,s as t,S as i}from"./index-CBkxY9s9.js";import{e as s}from"./enterprise-api-COduTEQq.js";import{u as r}from"./vue-router-D-yLC68c.js";import l from"./enterprise-operate-modal-DexPMpQ2.js";import{d as o}from"./default-time-ranges-JqpEQ5s5.js";import{_ as n}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{T as d}from"./table-id-const-DES3cCFe.js";import{M as p,b as u}from"./ant-design-vue-CcohkicM.js";import{d as m,r as c,a as f,e as y,b2 as g,z as v,b as j,o as h,y as b,c as _,ag as x,bz as k,u as w,K as I,J as S,ai as z,ah as C,F as E,be as N}from"./@vue-BVvo-xZd.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./lodash-2VbGH-WW.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./regular-const-vBMlR054.js";import"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import"./sortablejs-CRp0PNdb.js";const T={class:"smart-table-operate-block"},O={class:"smart-table-setting-block"},P={key:2},U={key:3,class:"smart-table-operate"},q={class:"smart-query-table-page"},R=m({__name:"enterprise-list",setup(m){const R=c([{title:"企业名称",dataIndex:"enterpriseName",minWidth:180,ellipsis:!0},{title:"统一社会信用代码",dataIndex:"unifiedSocialCreditCode",minWidth:170,ellipsis:!0},{title:"企业类型",dataIndex:"type",width:100},{title:"联系人",width:100,dataIndex:"contact",ellipsis:!0},{title:"联系人电话",width:120,dataIndex:"contactPhone",ellipsis:!0},{title:"邮箱",minWidth:100,dataIndex:"email",ellipsis:!0},{title:"状态",width:50,dataIndex:"disabledFlag"},{title:"创建人",width:60,dataIndex:"createUserName"},{title:"创建时间",dataIndex:"createTime",width:150},{title:"操作",dataIndex:"action",width:100}]),F={keywords:"",endTime:null,startTime:null,pageNum:1,pageSize:e,searchCount:!0},M=f({...F}),V=c(!1),W=c([]),$=c(0);let A=c();function B(e,a){M.startTime=a[0],M.endTime=a[1]}function D(){M.pageNum=1,K()}function J(){A.value=[],Object.assign(M,F),K()}async function K(){try{V.value=!0;let e=await s.pageQuery(M);const a=e.data.list;$.value=e.data.total,W.value=a}catch(e){t.captureError(e)}finally{V.value=!1}}function Q(e){p.confirm({title:"确定要删除吗？",content:"删除后，该信息将不可恢复",okText:"删除",okType:"danger",onOk(){!async function(e){try{i.show(),await s.delete(e),u.success("删除成功"),K()}catch(a){t.captureError(a)}finally{i.hide()}}(e)},cancelText:"取消",onCancel(){}})}let Z=r();const G=c();return y(K),(e,t)=>{const i=g("a-input"),r=g("a-form-item"),p=g("a-range-picker"),u=g("a-space"),m=g("SearchOutlined"),c=g("a-button"),f=g("ReloadOutlined"),y=g("a-button-group"),F=g("a-row"),Y=g("a-form"),H=g("PlusOutlined"),L=g("FileExcelOutlined"),X=g("a-table"),ee=g("a-pagination"),ae=g("a-card"),te=v("privilege");return h(),j(E,null,[b((h(),x(Y,{class:"smart-query-form"},{default:k((()=>[_(F,{class:"smart-query-form-row"},{default:k((()=>[_(r,{label:"关键字",class:"smart-query-form-item"},{default:k((()=>[_(i,{style:{width:"300px"},value:M.keywords,"onUpdate:value":t[0]||(t[0]=e=>M.keywords=e),placeholder:"企业名称/联系人/联系电话"},null,8,["value"])])),_:1}),_(r,{label:"创建时间",class:"smart-query-form-item"},{default:k((()=>[_(u,{direction:"vertical",size:12},{default:k((()=>[_(p,{value:w(A),"onUpdate:value":t[1]||(t[1]=e=>I(A)?A.value=e:A=e),presets:w(o),onChange:B},null,8,["value","presets"])])),_:1})])),_:1}),_(r,{class:"smart-query-form-item smart-margin-left10"},{default:k((()=>[_(y,null,{default:k((()=>[_(c,{type:"primary",onClick:D},{icon:k((()=>[_(m)])),default:k((()=>[S(" 查询 ")])),_:1}),_(c,{onClick:J},{icon:k((()=>[_(f)])),default:k((()=>[S(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[te,"oa:enterprise:query"]]),_(ae,{size:"small",bordered:!1,hoverable:!0},{default:k((()=>[_(F,{class:"smart-table-btn-block"},{default:k((()=>[z("div",T,[b((h(),x(c,{onClick:t[2]||(t[2]=e=>{G.value.showModal()}),type:"primary"},{icon:k((()=>[_(H)])),default:k((()=>[S(" 新建企业 ")])),_:1})),[[te,"oa:enterprise:add"]]),b((h(),x(c,{onClick:t[3]||(t[3]=e=>async function(){await s.exportExcel(M)}()),type:"primary"},{icon:k((()=>[_(L)])),default:k((()=>[S(" 导出数据（带水印） ")])),_:1})),[[te,"oa:enterprise:exportExcel"]])]),z("div",O,[_(n,{modelValue:R.value,"onUpdate:modelValue":t[4]||(t[4]=e=>R.value=e),tableId:w(d).BUSINESS.OA.ENTERPRISE,refresh:K},null,8,["modelValue","tableId"])])])),_:1}),_(X,{scroll:{x:1300},size:"small",dataSource:W.value,columns:R.value,rowKey:"enterpriseId",pagination:!1,loading:V.value,bordered:""},{bodyCell:k((({column:a,record:t,text:i})=>["disabledFlag"===a.dataIndex?(h(),j(E,{key:0},[S(N(i?"禁用":"启用"),1)],64)):C("",!0),"enterpriseName"===a.dataIndex?(h(),x(c,{key:1,type:"link",onClick:e=>{return a=t.enterpriseId,void Z.push({path:"/oa/enterprise/enterprise-detail",query:{enterpriseId:a}});var a},disabled:!e.$privilege("oa:enterprise:detail")},{default:k((()=>[S(N(t.enterpriseName),1)])),_:2},1032,["onClick","disabled"])):C("",!0),"type"===a.dataIndex?(h(),j("span",P,N(e.$smartEnumPlugin.getDescByValue("ENTERPRISE_TYPE_ENUM",i)),1)):C("",!0),"action"===a.dataIndex?(h(),j("div",U,[b((h(),x(c,{onClick:e=>{return a=t.enterpriseId,void G.value.showModal(a);var a},size:"small",type:"link"},{default:k((()=>[S("编辑")])),_:2},1032,["onClick"])),[[te,"oa:enterprise:update"]]),b((h(),x(c,{onClick:e=>Q(t.enterpriseId),size:"small",danger:"",type:"link"},{default:k((()=>[S("删除")])),_:2},1032,["onClick"])),[[te,"oa:enterprise:delete"]])])):C("",!0)])),_:1},8,["dataSource","columns","loading"]),z("div",q,[_(ee,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:w(a),defaultPageSize:M.pageSize,current:M.pageNum,"onUpdate:current":t[5]||(t[5]=e=>M.pageNum=e),pageSize:M.pageSize,"onUpdate:pageSize":t[6]||(t[6]=e=>M.pageSize=e),total:$.value,onChange:K,onShowSizeChange:K,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),_(l,{ref_key:"operateRef",ref:G,onRefresh:K},null,512)])),_:1})],64)}}});export{R as default};
