import{L as e,P as a,s as t}from"./index-CBkxY9s9.js";import{d as s}from"./default-time-ranges-JqpEQ5s5.js";import{u as l}from"./ua-parser-js-DNXwZhEt.js";import{l as r,c as o}from"./table-auto-height-BruH4Q9h.js";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{T as n}from"./table-id-const-DES3cCFe.js";import{d as u,r as d,a as p,e as m,l as c,b2 as g,z as f,b as v,o as y,y as j,c as b,ag as _,bz as h,u as I,J as w,ai as S,ah as x,F as z,be as N}from"./@vue-BVvo-xZd.js";import"./ant-design-vue-CcohkicM.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./dayjs-B6vKC6dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-2VbGH-WW.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./sortablejs-CRp0PNdb.js";const O={key:1},k={key:2},L={class:"smart-query-table-page"},P=u({__name:"login-log-list",setup(u){const P=d([{title:"用户ID",dataIndex:"userId",width:70},{title:"用户名",dataIndex:"userName",ellipsis:!0},{title:"类型",dataIndex:"userType",width:50,ellipsis:!0},{title:"IP",dataIndex:"loginIp",ellipsis:!0},{title:"IP地区",dataIndex:"loginIpRegion",ellipsis:!0},{title:"设备信息",dataIndex:"userAgent",ellipsis:!0},{title:"结果",dataIndex:"loginResult",ellipsis:!0},{title:"备注",dataIndex:"remark",ellipsis:!0},{title:"时间",dataIndex:"createTime",width:150}]),U={userName:"",ip:"",startDate:void 0,endDate:void 0,pageNum:1,pageSize:10},q=p({...U}),C=d([]),E=s;function R(e,a){q.startDate=a[0],q.endDate=a[1]}const D=d(!1),T=d([]),A=d(0);function G(){Object.assign(q,U),C.value=[],F()}function V(){q.pageNum=1,F()}async function F(){try{D.value=!0;let e=await r.queryList(q);for(const t of e.data.list){if(!t.userAgent)continue;let e=l(t.userAgent);t.browser=e.browser.name,t.os=e.os.name,t.device=e.device.vendor?e.device.vendor+e.device.model:""}const a=e.data.list;A.value=e.data.total,T.value=a}catch(e){t.captureError(e)}finally{D.value=!1}}const B=d(100),J=d(),$=d();function K(){o(B,[J,$],10)}return window.addEventListener("resize",K),m((()=>{F(),K()})),c((()=>{window.removeEventListener("resize",K)})),(t,s)=>{const l=g("a-input"),r=g("a-form-item"),o=g("a-range-picker"),u=g("SearchOutlined"),d=g("a-button"),p=g("ReloadOutlined"),m=g("a-button-group"),c=g("a-row"),U=g("a-form"),K=g("a-tag"),M=g("a-table"),Q=g("a-pagination"),Y=g("a-card"),H=f("privilege");return y(),v(z,null,[j((y(),_(U,{class:"smart-query-form",ref_key:"queryFormRef",ref:$},{default:h((()=>[b(c,{class:"smart-query-form-row"},{default:h((()=>[b(r,{label:"用户名称",class:"smart-query-form-item"},{default:h((()=>[b(l,{style:{width:"300px"},value:q.userName,"onUpdate:value":s[0]||(s[0]=e=>q.userName=e),placeholder:"用户名称"},null,8,["value"])])),_:1}),b(r,{label:"用户IP",class:"smart-query-form-item"},{default:h((()=>[b(l,{style:{width:"120px"},value:q.ip,"onUpdate:value":s[1]||(s[1]=e=>q.ip=e),placeholder:"IP"},null,8,["value"])])),_:1}),b(r,{label:"时间",class:"smart-query-form-item"},{default:h((()=>[b(o,{onChange:R,value:C.value,"onUpdate:value":s[2]||(s[2]=e=>C.value=e),presets:I(E),style:{width:"240px"}},null,8,["value","presets"])])),_:1}),b(r,{class:"smart-query-form-item smart-margin-left10"},{default:h((()=>[b(m,null,{default:h((()=>[b(d,{type:"primary",onClick:V},{icon:h((()=>[b(u)])),default:h((()=>[w(" 查询 ")])),_:1}),b(d,{onClick:G},{icon:h((()=>[b(p)])),default:h((()=>[w(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[H,"support:loginLog:query"]]),b(Y,{size:"small",bordered:!1,hoverable:!0},{default:h((()=>[b(c,{justify:"end",ref_key:"tableOperatorRef",ref:J},{default:h((()=>[b(i,{class:"smart-margin-bottom5",modelValue:P.value,"onUpdate:modelValue":s[3]||(s[3]=e=>P.value=e),tableId:I(n).SUPPORT.LOGIN_LOG,refresh:F},null,8,["modelValue","tableId"])])),_:1},512),b(M,{size:"small",dataSource:T.value,columns:P.value,bordered:"",rowKey:"loginLogId",pagination:!1,loading:D.value,scroll:{y:B.value}},{bodyCell:h((({text:a,record:s,column:l})=>["loginResult"===l.dataIndex?(y(),v(z,{key:0},[a===I(e).LOGIN_SUCCESS.value?(y(),_(K,{key:0,color:"success"},{default:h((()=>[w("登录成功")])),_:1})):x("",!0),a===I(e).LOGIN_FAIL.value?(y(),_(K,{key:1,color:"error"},{default:h((()=>[w("登录失败")])),_:1})):x("",!0),a===I(e).LOGIN_OUT.value?(y(),_(K,{key:2,color:"processing"},{default:h((()=>[w("退出登录")])),_:1})):x("",!0)],64)):x("",!0),"userAgent"===l.dataIndex?(y(),v("div",O,N(s.browser)+" / "+N(s.os)+" / "+N(s.device),1)):x("",!0),"userType"===l.dataIndex?(y(),v("span",k,N(t.$smartEnumPlugin.getDescByValue("USER_TYPE_ENUM",a)),1)):x("",!0)])),_:1},8,["dataSource","columns","loading","scroll"]),S("div",L,[b(Q,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:I(a),defaultPageSize:q.pageSize,current:q.pageNum,"onUpdate:current":s[4]||(s[4]=e=>q.pageNum=e),pageSize:q.pageSize,"onUpdate:pageSize":s[5]||(s[5]=e=>q.pageSize=e),total:A.value,onChange:F,onShowSizeChange:F,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1})],64)}}});export{P as default};
