import e from"./help-doc-form-drawer-ZFn5Rim3.js";import{c as a,v as t,s as l,P as o}from"./index-CBkxY9s9.js";import{_ as s}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{d as i}from"./default-time-ranges-JqpEQ5s5.js";import{T as r}from"./table-id-const-DES3cCFe.js";import{M as n,b as d}from"./ant-design-vue-CcohkicM.js";import{d as u,a as c,r as p,e as m,w as h,b2 as f,z as g,b as v,o as y,F as w,y as b,c as _,ag as k,bz as I,u as C,J as D,ai as z,ah as S,be as x}from"./@vue-BVvo-xZd.js";const O={class:"smart-table-operate-block"},q={class:"smart-table-setting-block"},j={key:1,class:"smart-table-operate"},P={class:"smart-query-table-page"},N=u({__name:"help-doc-list",props:{helpDocCatalogId:Number},setup(u){const N=u,T={helpDocCatalogId:N.helpDocCatalogId,keywords:"",createTimeBegin:null,createTimeEnd:null,pageNum:1,pageSize:a},U=c({...T}),E=p([{title:"标题",dataIndex:"title",ellipsis:!0},{title:"目录",dataIndex:"helpDocCatalogName",width:120,ellipsis:!0},{title:"作者",dataIndex:"author",width:110,ellipsis:!0},{title:"排序",dataIndex:"sort",width:90},{title:"页面浏览量",dataIndex:"pageViewCount",width:90},{title:"用户浏览量",dataIndex:"userViewCount",width:90},{title:"创建时间",dataIndex:"createTime",width:150},{title:"操作",dataIndex:"action",fixed:"right",width:90}]),V=p([]),R=p(0),B=p(!1);async function F(){try{B.value=!0;const e=await t.query(U);V.value=e.data.list,R.value=e.data.total}catch(e){l.captureError(e)}finally{B.value=!1}}function J(){U.pageNum=1,F()}function L(){Object.assign(U,T),M.value=[],H.value=[],F()}m((()=>{F()}));const M=p([]),H=p([]);function K(e,a){U.createTimeBegin=a[0],U.createTimeEnd=a[1]}const Q=p();function $(e){Q.value.showModal(e)}function A(e){n.confirm({title:"提示",content:"确认删除此数据吗?",onOk(){!async function(e){try{B.value=!0,await t.delete(e),d.success("删除成功"),F()}catch(a){l.captureError(a)}finally{B.value=!1}}(e)}})}return h((()=>N.helpDocCatalogId),(()=>{U.helpDocCatalogId=N.helpDocCatalogId,J()}),{immediate:!0}),(a,t)=>{const l=f("a-input"),n=f("a-form-item"),d=f("a-range-picker"),u=f("SearchOutlined"),c=f("a-button"),p=f("ReloadOutlined"),m=f("a-button-group"),h=f("a-row"),N=f("a-form"),T=f("PlusOutlined"),M=f("router-link"),G=f("a-table"),W=f("a-pagination"),X=f("a-card"),Y=g("privilege");return y(),v(w,null,[b((y(),k(N,{class:"smart-query-form"},{default:I((()=>[_(h,{class:"smart-query-form-row"},{default:I((()=>[_(n,{label:"关键字",class:"smart-query-form-item"},{default:I((()=>[_(l,{style:{width:"300px"},value:U.keywords,"onUpdate:value":t[0]||(t[0]=e=>U.keywords=e),placeholder:"标题、作者"},null,8,["value"])])),_:1}),_(n,{label:"创建时间",class:"smart-query-form-item"},{default:I((()=>[_(d,{presets:C(i),value:H.value,"onUpdate:value":t[1]||(t[1]=e=>H.value=e),onChange:K,style:{width:"220px"}},null,8,["presets","value"])])),_:1}),_(n,{class:"smart-query-form-item smart-margin-left10"},{default:I((()=>[_(m,null,{default:I((()=>[_(c,{type:"primary",onClick:J},{icon:I((()=>[_(u)])),default:I((()=>[D(" 查询 ")])),_:1}),_(c,{onClick:L},{icon:I((()=>[_(p)])),default:I((()=>[D(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[Y,"support:helpDoc:query"]]),_(X,{size:"small",bordered:!1},{default:I((()=>[_(h,{class:"smart-table-btn-block"},{default:I((()=>[z("div",O,[b((y(),k(c,{type:"primary",onClick:t[2]||(t[2]=e=>$())},{icon:I((()=>[_(T)])),default:I((()=>[D(" 新建 ")])),_:1})),[[Y,"support:helpDoc:add"]])]),z("div",q,[_(s,{modelValue:E.value,"onUpdate:modelValue":t[3]||(t[3]=e=>E.value=e),tableId:C(r).SUPPORT.HELP_DOC,refresh:F},null,8,["modelValue","tableId"])])])),_:1}),_(G,{rowKey:"helpDocId",columns:E.value,scroll:{x:1e3},dataSource:V.value,pagination:!1,loading:B.value,size:"small",bordered:""},{bodyCell:I((({column:e,record:a})=>["title"===e.dataIndex?(y(),k(M,{key:0,tag:"a",target:"_blank",to:{path:"/help-doc/detail",query:{helpDocId:a.helpDocId}}},{default:I((()=>[D(x(a.title),1)])),_:2},1032,["to"])):"action"===e.dataIndex?(y(),v("div",j,[b((y(),k(c,{type:"link",onClick:e=>$(a.helpDocId)},{default:I((()=>[D("编辑")])),_:2},1032,["onClick"])),[[Y,"support:helpDoc:update"]]),b((y(),k(c,{type:"link",danger:"",onClick:e=>A(a.helpDocId)},{default:I((()=>[D("删除")])),_:2},1032,["onClick"])),[[Y,"support:helpDoc:delete"]])])):S("",!0)])),_:1},8,["columns","dataSource","loading"]),z("div",P,[_(W,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:C(o),defaultPageSize:U.pageSize,current:U.pageNum,"onUpdate:current":t[4]||(t[4]=e=>U.pageNum=e),pageSize:U.pageSize,"onUpdate:pageSize":t[5]||(t[5]=e=>U.pageSize=e),total:R.value,onChange:F,onShowSizeChange:F,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1}),_(e,{ref_key:"helpDocFormDrawerRef",ref:Q,onReloadList:F},null,512)],64)}}});export{N as _};
