import{P as e,U as a,F as t,k as l,s as i}from"./index-CBkxY9s9.js";import{_ as o}from"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{d as s}from"./default-time-ranges-JqpEQ5s5.js";import{F as u}from"./index-DVmSW_0l.js";import{d as n,r as d,a as p,e as m,b2 as c,z as f,b as v,o as y,y as h,c as g,ag as _,bz as j,u as w,J as b,ai as x,ah as z,be as S,F as T}from"./@vue-BVvo-xZd.js";import"./ant-design-vue-CcohkicM.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./dayjs-B6vKC6dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-2VbGH-WW.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./sortablejs-CRp0PNdb.js";const k={class:"smart-table-operate-block"},E={class:"smart-table-setting-block"},I={key:0},U={key:1},N={key:2,class:"smart-table-operate"},C={class:"smart-query-table-page"},F=n({__name:"file-list",setup(n){const F=d([{title:"主键ID",dataIndex:"fileId",ellipsis:!0,width:70},{title:"文件夹",dataIndex:"folderType",ellipsis:!0,width:100},{title:"文件名称",dataIndex:"fileName",width:200},{title:"文件大小",dataIndex:"fileSize",ellipsis:!0,width:100},{title:"文件类型",dataIndex:"fileType",ellipsis:!0,width:80},{title:"上传人",dataIndex:"creatorName",ellipsis:!0,width:100},{title:"人类型",dataIndex:"creatorUserType",ellipsis:!0,width:100},{title:"上传时间",dataIndex:"createTime",ellipsis:!0,width:150},{title:"操作",dataIndex:"action",width:120,fixed:"right"}]),M={folderType:void 0,fileName:void 0,fileKey:void 0,fileType:void 0,creatorName:void 0,createTime:[],createTimeBegin:void 0,createTimeEnd:void 0,pageNum:1,pageSize:10},q=p({...M}),P=d(!1),O=d([]),K=d(0);function B(){let e=q.pageSize;Object.assign(q,M),q.pageSize=e,D()}async function D(){P.value=!0;try{let e=await l.queryPage(q);for(const a of e.data.list)a.fileSize=R(a.fileSize);O.value=e.data.list,K.value=e.data.total}catch(e){i.captureError(e)}finally{P.value=!1}}function L(e,a){q.createTimeBegin=a[0],q.createTimeEnd=a[1]}function R(e){if(!e)return"";var a=1024;return e<a?e+"B":e<Math.pow(a,2)?(e/a).toFixed(2)+"KB":e<Math.pow(a,3)?(e/Math.pow(a,2)).toFixed(2)+"MB":e<Math.pow(a,4)?(e/Math.pow(a,3)).toFixed(2)+"G":(e/Math.pow(a,4)).toFixed(2)+"T"}const V=d();m(D);const Y=d(!1);function $(){Y.value=!0}function G(){Y.value=!1,D()}return(n,d)=>{const p=c("a-form-item"),m=c("a-input"),M=c("a-range-picker"),R=c("SearchOutlined"),J=c("a-button"),A=c("ReloadOutlined"),Q=c("a-button-group"),H=c("a-row"),W=c("a-form"),X=c("cloud-upload-outlined"),Z=c("a-table"),ee=c("a-pagination"),ae=c("a-modal"),te=c("a-card"),le=f("privilege");return y(),v(T,null,[h((y(),_(W,{class:"smart-query-form"},{default:j((()=>[g(H,{class:"smart-query-form-row"},{default:j((()=>[g(p,{label:"文件夹类型",class:"smart-query-form-item"},{default:j((()=>[g(o,{width:"150px",value:q.folderType,"onUpdate:value":d[0]||(d[0]=e=>q.folderType=e),enumName:"FILE_FOLDER_TYPE_ENUM",placeholder:"文件夹类型"},null,8,["value"])])),_:1}),g(p,{label:"文件名",class:"smart-query-form-item"},{default:j((()=>[g(m,{style:{width:"150px"},value:q.fileName,"onUpdate:value":d[1]||(d[1]=e=>q.fileName=e),placeholder:"文件名"},null,8,["value"])])),_:1}),g(p,{label:"文件Key",class:"smart-query-form-item"},{default:j((()=>[g(m,{style:{width:"150px"},value:q.fileKey,"onUpdate:value":d[2]||(d[2]=e=>q.fileKey=e),placeholder:"文件Key"},null,8,["value"])])),_:1}),g(p,{label:"文件类型",class:"smart-query-form-item"},{default:j((()=>[g(m,{style:{width:"150px"},value:q.fileType,"onUpdate:value":d[3]||(d[3]=e=>q.fileType=e),placeholder:"文件类型"},null,8,["value"])])),_:1}),g(p,{label:"创建人",class:"smart-query-form-item"},{default:j((()=>[g(m,{style:{width:"150px"},value:q.creatorName,"onUpdate:value":d[4]||(d[4]=e=>q.creatorName=e),placeholder:"创建人"},null,8,["value"])])),_:1}),g(p,{label:"创建时间",class:"smart-query-form-item"},{default:j((()=>[g(M,{value:q.createTime,"onUpdate:value":d[5]||(d[5]=e=>q.createTime=e),presets:w(s),style:{width:"220px"},onChange:L},null,8,["value","presets"])])),_:1}),g(p,{class:"smart-query-form-item"},{default:j((()=>[g(Q,null,{default:j((()=>[g(J,{type:"primary",onClick:D},{icon:j((()=>[g(R)])),default:j((()=>[b(" 查询 ")])),_:1}),g(J,{onClick:B},{icon:j((()=>[g(A)])),default:j((()=>[b(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[le,"support:file:query"]]),g(te,{size:"small",bordered:!1,hoverable:!0},{default:j((()=>[g(H,{class:"smart-table-btn-block"},{default:j((()=>[x("div",k,[g(J,{type:"primary",onClick:$},{icon:j((()=>[g(X)])),default:j((()=>[b(" 上传文件 ")])),_:1})]),x("div",E,[g(r,{modelValue:F.value,"onUpdate:modelValue":d[6]||(d[6]=e=>F.value=e),tableId:null,refresh:D},null,8,["modelValue"])])])),_:1}),g(Z,{size:"small",scroll:{x:1300},dataSource:O.value,columns:F.value,rowKey:"fileId",bordered:"",loading:P.value,pagination:!1},{bodyCell:j((({text:e,record:a,column:t})=>["folderType"===t.dataIndex?(y(),v("span",I,S(n.$smartEnumPlugin.getDescByValue("FILE_FOLDER_TYPE_ENUM",e)),1)):z("",!0),"creatorUserType"===t.dataIndex?(y(),v("span",U,S(n.$smartEnumPlugin.getDescByValue("USER_TYPE_ENUM",e)),1)):z("",!0),"action"===t.dataIndex?(y(),v("div",N,[g(J,{onClick:e=>{return t=a,void V.value.showPreview(t);var t},type:"link"},{default:j((()=>[b("查看")])),_:2},1032,["onClick"]),g(J,{onClick:e=>async function(e){try{await l.downLoadFile(e.fileKey)}catch(a){i.captureError(a)}}(a),type:"link"},{default:j((()=>[b("下载")])),_:2},1032,["onClick"])])):z("",!0)])),_:1},8,["dataSource","columns","loading"]),x("div",C,[g(ee,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:w(e),defaultPageSize:q.pageSize,current:q.pageNum,"onUpdate:current":d[7]||(d[7]=e=>q.pageNum=e),pageSize:q.pageSize,"onUpdate:pageSize":d[8]||(d[8]=e=>q.pageSize=e),total:K.value,onChange:D,onShowSizeChange:D,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),g(u,{ref_key:"filePreviewModalRef",ref:V},null,512),g(ae,{open:Y.value,"onUpdate:open":d[9]||(d[9]=e=>Y.value=e),title:"上传文件",onOnCancel:G,onOk:G},{default:j((()=>[g(a,{"list-type":"text",maxUploadSize:5,buttonText:"点击上传文件",defaultFileList:[],multiple:!0,folder:w(t).COMMON.value},null,8,["folder"])])),_:1},8,["open"])])),_:1})],64)}}});export{F as default};
