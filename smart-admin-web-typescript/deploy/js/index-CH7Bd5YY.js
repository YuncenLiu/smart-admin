import{O as e,o as a}from"./operate-log-detail-modal-SSBkO98b.js";import{P as t,s}from"./index-CBkxY9s9.js";import{d as o}from"./default-time-ranges-JqpEQ5s5.js";import{u as i}from"./ua-parser-js-DNXwZhEt.js";import{d as r,r as l,a as n,e as u,b2 as d,b as p,o as m,c,ai as g,bz as v,u as f,J as j,ag as y,ah as h,be as b,F as w}from"./@vue-BVvo-xZd.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./ant-design-vue-CcohkicM.js";import"./@babel-rSvM8Ko2.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./dayjs-B6vKC6dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./lodash-2VbGH-WW.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";const x={key:1},_={key:2,class:"smart-table-operate"},z={class:"smart-query-table-page"},S=r({__name:"index",setup(r){const S=l([{title:"操作模块",dataIndex:"module",ellipsis:!0,width:120},{title:"操作内容",dataIndex:"content",ellipsis:!0},{title:"IP地区",dataIndex:"ipRegion",ellipsis:!0,width:120},{title:"客户端",dataIndex:"userAgent",ellipsis:!0,width:140},{title:"时间",dataIndex:"createTime",width:150},{title:"结果",dataIndex:"successFlag",width:60},{title:"操作",dataIndex:"action",fixed:"right",width:60}]),I={userName:"",successFlag:void 0,startDate:void 0,endDate:void 0,pageNum:1,pageSize:10},k=n({...I}),C=l([]),q=o;function O(e,a){k.startDate=a[0],k.endDate=a[1]}const F=l(!1),D=l([]),N=l(0);function P(){Object.assign(k,I),C.value=[],L()}function A(){k.pageNum=1,L()}async function L(){try{F.value=!0;let e=await a.queryListLogin(k);for(const a of e.data.list){if(!a.userAgent)continue;let e=i(a.userAgent);a.browser=e.browser.name,a.os=e.os.name,a.device=e.device.vendor?e.device.vendor+e.device.model:""}const t=e.data.list;N.value=e.data.total,D.value=t}catch(e){s.captureError(e)}finally{F.value=!1}}u(L);const U=l();return(a,s)=>{const o=d("a-range-picker"),i=d("a-form-item"),r=d("a-radio-button"),l=d("a-radio-group"),n=d("SearchOutlined"),u=d("a-button"),I=d("ReloadOutlined"),E=d("a-button-group"),J=d("a-row"),R=d("a-form"),B=d("a-tag"),K=d("a-table"),M=d("a-pagination");return m(),p(w,null,[c(R,{class:"smart-query-form"},{default:v((()=>[c(J,{class:"smart-query-form-row"},{default:v((()=>[c(i,{label:"请求时间",class:"smart-query-form-item"},{default:v((()=>[c(o,{onChange:O,value:C.value,"onUpdate:value":s[0]||(s[0]=e=>C.value=e),presets:f(q),style:{width:"240px"}},null,8,["value","presets"])])),_:1}),c(i,{label:"快速筛选",class:"smart-query-form-item"},{default:v((()=>[c(l,{value:k.successFlag,"onUpdate:value":s[1]||(s[1]=e=>k.successFlag=e),onChange:A},{default:v((()=>[c(r,{value:void 0},{default:v((()=>[j("全部")])),_:1}),c(r,{value:!0},{default:v((()=>[j("成功")])),_:1}),c(r,{value:!1},{default:v((()=>[j("失败")])),_:1})])),_:1},8,["value"])])),_:1}),c(i,{class:"smart-query-form-item smart-margin-left10"},{default:v((()=>[c(E,null,{default:v((()=>[c(u,{type:"primary",onClick:L},{icon:v((()=>[c(n)])),default:v((()=>[j(" 查询 ")])),_:1}),c(u,{onClick:P},{icon:v((()=>[c(I)])),default:v((()=>[j(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),c(K,{size:"small",loading:F.value,dataSource:D.value,columns:S.value,bordered:"",rowKey:"operateLogId",pagination:!1},{bodyCell:v((({text:e,record:a,column:t})=>["successFlag"===t.dataIndex?(m(),y(B,{key:0,color:e?"success":"error"},{default:v((()=>[j(b(e?"成功":"失败"),1)])),_:2},1032,["color"])):h("",!0),"userAgent"===t.dataIndex?(m(),p("div",x,b(a.browser)+" / "+b(a.os)+" / "+b(a.device),1)):h("",!0),"action"===t.dataIndex?(m(),p("div",_,[c(u,{onClick:e=>{return t=a.operateLogId,void U.value.show(t);var t},type:"link"},{default:v((()=>[j("详情")])),_:2},1032,["onClick"])])):h("",!0)])),_:1},8,["loading","dataSource","columns"]),g("div",z,[c(M,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:f(t),defaultPageSize:k.pageSize,current:k.pageNum,"onUpdate:current":s[2]||(s[2]=e=>k.pageNum=e),pageSize:k.pageSize,"onUpdate:pageSize":s[3]||(s[3]=e=>k.pageSize=e),total:N.value,onChange:L,onShowSizeChange:L,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),c(e,{ref_key:"detailModal",ref:U},null,512)],64)}}});export{S as default};
