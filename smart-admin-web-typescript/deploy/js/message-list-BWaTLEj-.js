import{P as e,x as a,s as t,S as s}from"./index-CBkxY9s9.js";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{_ as i}from"./message-send-form.vue_vue_type_script_setup_true_lang-DGbs7W-L.js";import{T as o}from"./table-id-const-DES3cCFe.js";import{M as n,b as u}from"./ant-design-vue-CcohkicM.js";import{d,r as m,a as p,e as c,b2 as g,b as f,o as _,c as v,bz as y,J as j,ai as h,u as b,ah as x,F as w,be as S}from"./@vue-BVvo-xZd.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./lodash-2VbGH-WW.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./sortablejs-CRp0PNdb.js";import"./message-receiver-modal.vue_vue_type_script_setup_true_lang-DNXGvfv6.js";const z={class:"smart-table-operate-block"},k={class:"smart-table-setting-block"},I={key:2,class:"smart-table-operate"},T={class:"smart-query-table-page"},E=d({__name:"message-list",setup(d){const E=m([{title:"消息类型",dataIndex:"messageType",ellipsis:!0,width:100},{title:"消息标题",dataIndex:"title",ellipsis:!0},{title:"消息内容",dataIndex:"content",ellipsis:!0},{title:"接收人ID",dataIndex:"receiverUserId",ellipsis:!0,width:100},{title:"已读",dataIndex:"readFlag",width:50},{title:"已读时间",dataIndex:"readTime",width:150},{title:"创建时间",dataIndex:"createTime",width:150},{title:"操作",dataIndex:"action",fixed:"right",width:60}]),U={searchWord:void 0,pageNum:1,pageSize:10,createTime:[],readFlag:null,startDate:null,endDate:null,messageType:null};function C(e,a){M.startDate=a[0],M.endDate=a[1]}const M=p({...U}),q=m(!1),N=m([]),O=m(0);function P(){let e=M.pageSize;Object.assign(M,U),M.pageSize=e,F()}function D(){M.pageNum=1,F()}async function F(){q.value=!0;try{let e=await a.queryAdminMessage(M);N.value=e.data.list,O.value=e.data.total}catch(e){t.captureError(e)}finally{q.value=!1}}c(F);const A=m();function R(e){A.value.show(e)}function G(e){n.confirm({title:"提示",content:"确定要删除选吗?",okText:"删除",okType:"danger",onOk(){!async function(e){try{s.show(),await a.deleteMessage(e.messageId),u.success("删除成功"),F()}catch(l){t.captureError(l)}finally{s.hide()}}(e)},cancelText:"取消",onCancel(){}})}return(a,t)=>{const s=g("a-input"),n=g("a-form-item"),u=g("a-range-picker"),d=g("SearchOutlined"),m=g("a-button"),p=g("ReloadOutlined"),c=g("a-row"),U=g("a-form"),V=g("PlusOutlined"),L=g("a-table"),W=g("a-pagination"),B=g("a-card");return _(),f(w,null,[v(U,{class:"smart-query-form"},{default:y((()=>[v(c,{class:"smart-query-form-row"},{default:y((()=>[v(n,{label:"关键词",class:"smart-query-form-item"},{default:y((()=>[v(s,{style:{width:"150px"},value:M.searchWord,"onUpdate:value":t[0]||(t[0]=e=>M.searchWord=e),placeholder:"关键词"},null,8,["value"])])),_:1}),v(n,{label:"类型",class:"smart-query-form-item"},{default:y((()=>[v(l,{style:{width:"150px"},value:M.messageType,"onUpdate:value":t[1]||(t[1]=e=>M.messageType=e),placeholder:"消息类型","enum-name":"MESSAGE_TYPE_ENUM"},null,8,["value"])])),_:1}),v(n,{label:"是否已读",class:"smart-query-form-item"},{default:y((()=>[v(l,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:M.readFlag,"onUpdate:value":t[2]||(t[2]=e=>M.readFlag=e)},null,8,["value"])])),_:1}),v(n,{label:"创建时间",class:"smart-query-form-item"},{default:y((()=>[v(u,{value:M.createTime,"onUpdate:value":t[3]||(t[3]=e=>M.createTime=e),style:{width:"200px"},onChange:C},null,8,["value"])])),_:1}),v(n,{class:"smart-query-form-item"},{default:y((()=>[v(m,{type:"primary",onClick:D},{icon:y((()=>[v(d)])),default:y((()=>[j(" 查询 ")])),_:1}),v(m,{onClick:P,class:"smart-margin-left10"},{icon:y((()=>[v(p)])),default:y((()=>[j(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1}),v(B,{size:"small",bordered:!1,hoverable:!0},{default:y((()=>[v(c,{class:"smart-table-btn-block"},{default:y((()=>[h("div",z,[v(m,{onClick:R,type:"primary"},{icon:y((()=>[v(V)])),default:y((()=>[j(" 发送消息 ")])),_:1})]),h("div",k,[v(r,{modelValue:E.value,"onUpdate:modelValue":t[4]||(t[4]=e=>E.value=e),tableId:b(o).SUPPORT.MAIL,refresh:F},null,8,["modelValue","tableId"])])])),_:1}),v(L,{size:"small",dataSource:N.value,columns:E.value,rowKey:"telephoneId",bordered:"",loading:q.value,pagination:!1},{bodyCell:y((({record:e,column:t,text:s})=>["readFlag"===t.dataIndex?(_(),f(w,{key:0},[j(S(s?"已读":"未读"),1)],64)):x("",!0),"messageType"===t.dataIndex?(_(),f(w,{key:1},[j(S(a.$smartEnumPlugin.getDescByValue("MESSAGE_TYPE_ENUM",s)),1)],64)):x("",!0),"action"===t.dataIndex?(_(),f("div",I,[v(m,{onClick:a=>G(e),danger:"",type:"link"},{default:y((()=>[j("删除")])),_:2},1032,["onClick"])])):x("",!0)])),_:1},8,["dataSource","columns","loading"]),h("div",T,[v(W,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:b(e),defaultPageSize:M.pageSize,current:M.pageNum,"onUpdate:current":t[5]||(t[5]=e=>M.pageNum=e),pageSize:M.pageSize,"onUpdate:pageSize":t[6]||(t[6]=e=>M.pageSize=e),total:O.value,onChange:F,onShowSizeChange:F,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),v(i,{ref_key:"formRef",ref:A,onReloadList:F},null,512)])),_:1})],64)}}});export{E as default};
