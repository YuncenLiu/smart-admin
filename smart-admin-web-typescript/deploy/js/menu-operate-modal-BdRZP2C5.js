import{_ as e}from"./lodash-2VbGH-WW.js";import{_ as a}from"./menu-tree-select.vue_vue_type_script_setup_true_lang-DmbFBLRP.js";import{m as l}from"./menu-api-59Sr21sk.js";import{I as t}from"./index-DKHPqhkv.js";import{X as n,M as u,Y as s,S as r,s as d,a as o}from"./index-CBkxY9s9.js";import{b as i}from"./ant-design-vue-CcohkicM.js";import{d as m,r as p,a as c,b2 as v,ag as h,o as f,bz as b,c as y,ai as g,u as k,b as _,ah as j,F as T,b0 as U,J as I,be as F,b3 as x,n as w}from"./@vue-BVvo-xZd.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const M={class:"footer"},N=o(m({__name:"menu-operate-modal",emits:["reloadList"],setup(o,{expose:m,emit:N}){const C=N,P=p(!1),O=p(),E=p();function S(){w((()=>{O.value&&O.value.queryMenuTree(),E.value&&E.value.queryMenuTree()}))}function q(){Object.assign(z,L),A.value.resetFields(),P.value=!1}const A=p(),L={menuId:void 0,menuName:void 0,menuType:u.CATALOG.value,icon:void 0,parentId:void 0,path:void 0,permsType:n.SA_TOKEN.value,webPerms:void 0,apiPerms:void 0,sort:void 0,visibleFlag:!0,cacheFlag:!1,component:void 0,contextMenuId:void 0,disabledFlag:!1,frameFlag:!1,frameUrl:void 0};let z=c({...L});const D={menuType:[{required:!0,message:"菜单类型不能为空"}],permsType:[{required:!0,message:"权限类型不能为空"}],menuName:[{required:!0,message:"菜单名称不能为空"},{max:20,message:"菜单名称不能大于20个字符",trigger:"blur"}],frameUrl:[{required:!0,message:"外链地址不能为空"},{max:500,message:"外链地址不能大于500个字符",trigger:"blur"}],path:[{required:!0,message:"路由地址不能为空"},{max:100,message:"路由地址不能大于100个字符",trigger:"blur"}]};const V=async a=>{var t;if(await(t=A.value,new Promise((e=>{t.validate().then((()=>{e(!0)})).catch((()=>{e(!1)}))})))){r.show();try{let t=e.cloneDeep(z);t.parentId||(t.parentId=0),t.menuId?await l.updateMenu(t):await l.addMenu(t),i.success((t.menuId?"修改":"添加")+"成功"),a?function(){S();const e=z.menuType,a=z.parentId,l=z.webPerms;Object.assign(z,L),A.value.resetFields(),z.menuType=e,z.parentId=a,z.menuType===u.POINTS.value&&(z.contextMenuId=a),l&&l.lastIndexOf(":")&&(z.webPerms=l.substring(0,l.lastIndexOf(":")+1))}():q(),C("reloadList")}catch(n){d.captureError(n)}finally{r.hide()}}else i.error("参数验证错误，请仔细填写表单数据!")};function G(e){z.icon=e}return m({showDrawer:async function(a){Object.assign(z,L),a&&!e.isEmpty(a)&&(Object.assign(z,a),z.parentId===s&&(z.parentId=null)),P.value=!0,S()}}),(e,l)=>{const s=v("a-radio-button"),r=v("a-radio-group"),d=v("a-form-item"),o=v("a-input"),i=v("a-switch"),m=v("a-radio"),p=v("a-input-number"),c=v("a-form"),w=v("a-button"),N=v("a-drawer");return f(),h(N,{"body-style":{paddingBottom:"80px"},maskClosable:!0,title:k(z).menuId?"编辑":"添加",open:P.value,width:600,onClose:q,destroyOnClose:""},{default:b((()=>[y(c,{ref_key:"formRef",ref:A,labelCol:{span:5},labelWrap:!0,model:k(z),rules:D},{default:b((()=>[y(d,{label:"菜单类型",name:"menuType"},{default:b((()=>[y(r,{value:k(z).menuType,"onUpdate:value":l[0]||(l[0]=e=>k(z).menuType=e),"button-style":"solid"},{default:b((()=>[(f(!0),_(T,null,U(k(u),(e=>(f(),h(s,{key:e.value,value:e.value},{default:b((()=>[I(F(e.desc),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),y(d,{label:k(z).menuType===k(u).CATALOG.value?"上级目录":"上级菜单"},{default:b((()=>[y(a,{ref_key:"parentMenuTreeSelect",ref:E,value:k(z).parentId,"onUpdate:value":l[1]||(l[1]=e=>k(z).parentId=e)},null,8,["value"])])),_:1},8,["label"]),k(z).menuType===k(u).CATALOG.value||k(z).menuType===k(u).MENU.value?(f(),_(T,{key:0},[y(d,{label:"菜单名称",name:"menuName"},{default:b((()=>[y(o,{value:k(z).menuName,"onUpdate:value":l[2]||(l[2]=e=>k(z).menuName=e),placeholder:"请输入菜单名称"},null,8,["value"])])),_:1}),y(d,{label:"菜单图标",name:"icon"},{default:b((()=>[y(t,{onUpdateIcon:G},{iconSelect:b((()=>[y(o,{value:k(z).icon,"onUpdate:value":l[3]||(l[3]=e=>k(z).icon=e),placeholder:"请输入菜单图标",style:{width:"200px"}},null,8,["value"]),(f(),h(x(e.$antIcons[k(z).icon]),{class:"smart-margin-left15",style:{"font-size":"20px"}}))])),_:1})])),_:1}),k(z).menuType===k(u).MENU.value?(f(),h(d,{key:0,label:"路由地址",name:"path"},{default:b((()=>[y(o,{value:k(z).path,"onUpdate:value":l[4]||(l[4]=e=>k(z).path=e),placeholder:"请输入路由地址"},null,8,["value"])])),_:1})):j("",!0),k(z).menuType===k(u).MENU.value?(f(),_(T,{key:1},[k(z).frameFlag?(f(),h(d,{key:0,label:"外链地址",name:"frameUrl"},{default:b((()=>[y(o,{value:k(z).frameUrl,"onUpdate:value":l[5]||(l[5]=e=>k(z).frameUrl=e),placeholder:"请输入外链地址"},null,8,["value"])])),_:1})):(f(),h(d,{key:1,label:"组件地址",name:"component",help:"比如 商品列表：/business/erp/goods/goods-list.vue"},{default:b((()=>[y(o,{value:k(z).component,"onUpdate:value":l[6]||(l[6]=e=>k(z).component=e),placeholder:"请输入组件地址 默认带有开头/@/views"},null,8,["value"])])),_:1}))],64)):j("",!0),k(z).menuType===k(u).MENU.value?(f(),h(d,{key:2,label:"是否缓存",name:"cacheFlag"},{default:b((()=>[y(i,{checked:k(z).cacheFlag,"onUpdate:checked":l[7]||(l[7]=e=>k(z).cacheFlag=e),"checked-children":"开启缓存","un-checked-children":"不缓存"},null,8,["checked"])])),_:1})):j("",!0),k(z).menuType===k(u).MENU.value?(f(),h(d,{key:3,label:"是否外链",name:"frameFlag"},{default:b((()=>[y(i,{checked:k(z).frameFlag,"onUpdate:checked":l[8]||(l[8]=e=>k(z).frameFlag=e),"checked-children":"是外链","un-checked-children":"不是外链"},null,8,["checked"])])),_:1})):j("",!0),y(d,{label:"显示状态",name:"visibleFlag"},{default:b((()=>[y(i,{checked:k(z).visibleFlag,"onUpdate:checked":l[9]||(l[9]=e=>k(z).visibleFlag=e),"checked-children":"显示","un-checked-children":"不显示"},null,8,["checked"])])),_:1}),y(d,{label:"禁用状态",name:"disabledFlag"},{default:b((()=>[y(i,{checked:k(z).disabledFlag,"onUpdate:checked":l[10]||(l[10]=e=>k(z).disabledFlag=e),checkedValue:!1,unCheckedValue:!0,"checked-children":"启用","un-checked-children":"禁用"},null,8,["checked"])])),_:1})],64)):j("",!0),k(z).menuType===k(u).POINTS.value?(f(),_(T,{key:1},[y(d,{label:"功能点名称",name:"menuName"},{default:b((()=>[y(o,{value:k(z).menuName,"onUpdate:value":l[11]||(l[11]=e=>k(z).menuName=e),placeholder:"请输入功能点名称"},null,8,["value"])])),_:1}),y(d,{label:"功能点关联菜单"},{default:b((()=>[y(a,{ref_key:"contextMenuTreeSelect",ref:O,value:k(z).contextMenuId,"onUpdate:value":l[12]||(l[12]=e=>k(z).contextMenuId=e)},null,8,["value"])])),_:1}),y(d,{label:"功能点状态",name:"funcDisabledFlag"},{default:b((()=>[y(i,{checked:k(z).disabledFlag,"onUpdate:checked":l[13]||(l[13]=e=>k(z).disabledFlag=e),checkedValue:!1,unCheckedValue:!0,"checked-children":"启用","un-checked-children":"禁用"},null,8,["checked"])])),_:1}),y(d,{label:"权限类型",name:"permsType"},{default:b((()=>[y(r,{value:k(z).permsType,"onUpdate:value":l[14]||(l[14]=e=>k(z).permsType=e)},{default:b((()=>[(f(!0),_(T,null,U(k(n),(e=>(f(),h(m,{key:e.value,value:e.value},{default:b((()=>[I(F(e.desc),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),y(d,{label:"前端权限",name:"webPerms",help:"用于前端按钮等功能的展示和隐藏，搭配v-privilege使用"},{default:b((()=>[y(o,{value:k(z).webPerms,"onUpdate:value":l[15]||(l[15]=e=>k(z).webPerms=e),placeholder:"请输入前端权限"},null,8,["value"])])),_:1}),y(d,{label:"后端权限",name:"apiPerms",help:"后端@SaCheckPermission中的权限字符串，多个以英文逗号,分割"},{default:b((()=>[y(o,{value:k(z).apiPerms,"onUpdate:value":l[16]||(l[16]=e=>k(z).apiPerms=e),placeholder:"请输入后端权限"},null,8,["value"])])),_:1})],64)):j("",!0),y(d,{label:"排序",name:"sort",help:"值越小越靠前"},{default:b((()=>[y(p,{value:k(z).sort,"onUpdate:value":l[17]||(l[17]=e=>k(z).sort=e),min:0,placeholder:"请输入排序",style:{width:"100px"}},null,8,["value"])])),_:1})])),_:1},8,["model"]),g("div",M,[y(w,{style:{"margin-right":"8px"},onClick:q},{default:b((()=>[I("取消")])),_:1}),y(w,{style:{"margin-right":"8px"},type:"primary",onClick:l[18]||(l[18]=e=>V(!1))},{default:b((()=>[I("提交 ")])),_:1}),k(z).menuId?j("",!0):(f(),h(w,{key:0,type:"primary",onClick:l[19]||(l[19]=e=>V(!0))},{default:b((()=>[I("提交并添加下一个 ")])),_:1}))])])),_:1},8,["title","open"])}}}),[["__scopeId","data-v-e97e523b"]]);export{N as default};
