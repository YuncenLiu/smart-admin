import{n as e}from"./notice-api-BS5_b2B9.js";import{c as a,P as t}from"./index-CBkxY9s9.js";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang-Ca0kUvG5.js";import{u as i}from"./ua-parser-js-DNXwZhEt.js";import{d as o,r as s,a as l,b2 as n,b as d,o as u,c as p,ai as m,bz as c,J as f,ah as g,F as v,be as y,u as w}from"./@vue-BVvo-xZd.js";const I={class:"smart-query-table-page"},h=o({__name:"notice-view-record-list",props:{noticeId:{type:[Number,String]}},setup(o,{expose:h}){const S=o;h({onSearch:C});const _=[{title:"姓名",dataIndex:"employeeName"},{title:"查看次数",dataIndex:"pageViewCount"},{title:"首次查看设备",dataIndex:"firstIp"},{title:"首次查看时间",dataIndex:"createTime"},{title:"最后一次查看设备",dataIndex:"lastIp"},{title:"最后一次查看时间",dataIndex:"updateTime",with:80}],x=s([]),b=s(0),z=s(!1),k={noticeId:S.noticeId,departmentId:null,keywords:"",pageNum:1,pageSize:a},N=l({...k});function j(e){if(!e)return"";let a=i(e);return a.browser.name+"/"+a.os.name+"/"+(a.device.vendor?a.device.vendor+a.device.model:"")}async function q(){try{z.value=!0;const a=await e.queryViewRecord(N);for(const e of a.data.list)e.firstDevice=j(e.firstUserAgent),e.lastDevice=j(e.lastUserAgent);x.value=a.data.list,b.value=a.data.total}catch(a){}finally{z.value=!1}}function C(){N.pageNum=1,q()}function U(){Object.assign(N,k),q()}return(e,a)=>{const i=n("a-form-item"),o=n("a-input"),s=n("SearchOutlined"),l=n("a-button"),h=n("ReloadOutlined"),S=n("a-button-group"),k=n("a-row"),j=n("a-form"),O=n("a-table"),D=n("a-pagination");return u(),d("div",null,[p(j,{class:"smart-query-form"},{default:c((()=>[p(k,{class:"smart-query-form-row"},{default:c((()=>[p(i,{label:"部门",class:"smart-query-form-item",style:{width:"280px","margin-right":"20px"}},{default:c((()=>[p(r,{value:N.departmentId,"onUpdate:value":a[0]||(a[0]=e=>N.departmentId=e),width:"100%"},null,8,["value"])])),_:1}),p(i,{label:"关键字",class:"smart-query-form-item",style:{width:"280px"}},{default:c((()=>[p(o,{value:N.keywords,"onUpdate:value":a[1]||(a[1]=e=>N.keywords=e),placeholder:"姓名/IP/设备"},null,8,["value"])])),_:1}),p(i,{class:"smart-query-form-item smart-margin-left10"},{default:c((()=>[p(S,null,{default:c((()=>[p(l,{type:"primary",onClick:C},{icon:c((()=>[p(s)])),default:c((()=>[f(" 查询 ")])),_:1}),p(l,{onClick:U},{icon:c((()=>[p(h)])),default:c((()=>[f(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),p(O,{rowKey:"employeeId",columns:_,dataSource:x.value,pagination:!1,loading:z.value,size:"small",bordered:""},{bodyCell:c((({column:e,record:a,text:t})=>["employeeName"===e.dataIndex?(u(),d(v,{key:0},[f(y(t)+"("+y(a.departmentName)+") ",1)],64)):g("",!0),"firstIp"===e.dataIndex?(u(),d(v,{key:1},[f(y(t)+" ("+y(a.firstDevice)+") ",1)],64)):g("",!0),"lastIp"===e.dataIndex?(u(),d(v,{key:2},[f(y(t)+" ("+y(a.lastDevice)+") ",1)],64)):g("",!0)])),_:1},8,["dataSource","loading"]),m("div",I,[p(D,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:w(t),defaultPageSize:N.pageSize,current:N.pageNum,"onUpdate:current":a[2]||(a[2]=e=>N.pageNum=e),pageSize:N.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>N.pageSize=e),total:b.value,onChange:q,onShowSizeChange:q,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])}}});export{h as _};
