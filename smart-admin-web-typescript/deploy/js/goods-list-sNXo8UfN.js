const __vite__fileDeps=["js/index-iRk8ndmL.js","js/index.vue_vue_type_script_setup_true_lang-D394UfoC.js","js/@vue-BVvo-xZd.js","js/index-DdtqfZmR.js","js/goods-form-modal.vue_vue_type_script_setup_true_lang-Dmt1h8py.js","js/category-api-iaRaCfKr.js","js/index-CBkxY9s9.js","js/ant-design-vue-CcohkicM.js","js/@babel-rSvM8Ko2.js","js/@ant-design-D2dl84QQ.js","js/vue-Bbq_A2bw.js","js/@ctrl-DlzbjsCp.js","js/resize-observer-polyfill-OVnto9HH.js","js/@emotion-DXlYAqfy.js","js/stylis-YutRQeBK.js","js/vue-types-Sy1fKJ9U.js","js/dom-align-CCb293uS.js","js/lodash-es-BgZ_dRTG.js","js/dayjs-B6vKC6dp.js","js/async-validator-BTKOuuO-.js","js/throttle-debounce-w9OM8Bxz.js","css/ant-design-vue-Cm_1FYRq.css","js/lodash-2VbGH-WW.js","js/vue3-json-viewer-DGFKKWPN.js","css/vue3-json-viewer-DURLcZvU.css","js/vue-i18n-CEbWPeBD.js","js/@intlify-D18cTrFw.js","js/pinia-CgN6MZDh.js","js/axios-BlN9Xwzv.js","js/crypto-js-TV0Ce7JK.js","js/sm-crypto-CWaozmhJ.js","js/jsbn-DBh4-X7k.js","js/nprogress-CqoNXQnd.js","css/nprogress-BUMXTAWU.css","js/vue-router-D-yLC68c.js","js/mitt-CNZ6avp8.js","css/index-DW9mwiTX.css","js/index-BahEFL2h.js","js/index.vue_vue_type_script_setup_true_lang-CcaTzEf2.js","js/index-aLCuTyaK.js","js/enterprise-api-COduTEQq.js","js/index-DbW0BbRB.js","js/index.vue_vue_type_script_setup_true_lang-CCEjUz2j.js","js/index-BJdF7Uym.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{a as e,b as t,_ as a,g as l}from"./goods-form-modal.vue_vue_type_script_setup_true_lang-Dmt1h8py.js";import{_ as o,a as n,u as s,C as i,D as r,P as u,s as d,S as c}from"./index-CBkxY9s9.js";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{T as m}from"./table-id-const-DES3cCFe.js";import{_ as v}from"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import{_ as f}from"./lodash-2VbGH-WW.js";import{d as y}from"./dayjs-B6vKC6dp.js";import{d as g}from"./default-time-ranges-JqpEQ5s5.js";import{d as h,w as _,bn as b,r as O,e as x,b2 as k,b as w,o as S,ai as j,b1 as C,J as I,be as E,ah as z,F as D,ag as T,u as U,c as L,bz as q,b3 as A,aq as N,m as G,a as P,z as F,y as R}from"./@vue-BVvo-xZd.js";import{M as V,b as M}from"./ant-design-vue-CcohkicM.js";import"./category-api-iaRaCfKr.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./sortablejs-CRp0PNdb.js";const H={class:"container"},K={class:"table-title"},$={class:"filter",style:{"max-width":"300px","min-height":"40px"}},W={key:4,class:"smart-table-operate"},B={key:1,class:"error-component"},J=n(h({__name:"index",props:{value:{type:[Number,String,Array,Object]},column:{type:Object,default:()=>{}}},emits:["change","update:value"],setup(e,{emit:t}){const a=e,l={"enum-select":N((()=>o((()=>import("./index-iRk8ndmL.js")),__vite__mapDeps([0,1,2])))),"dict-select":N((()=>o((()=>import("./index-DdtqfZmR.js")),__vite__mapDeps([3,4,5,6,2,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,1])))),"employee-select":N((()=>o((()=>import("./index-BahEFL2h.js")),__vite__mapDeps([37,38,6,2,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36])))),"enterprise-select":N((()=>o((()=>import("./index-aLCuTyaK.js")),__vite__mapDeps([39,40,6,2,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36])))),"boolean-select":N((()=>o((()=>import("./index-DbW0BbRB.js")),__vite__mapDeps([41,42,22,9,2,10,11])))),"category-tree":N((()=>o((()=>import("./index-BJdF7Uym.js")),__vite__mapDeps([43,4,5,6,2,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,1]))))},n=Object.keys(l);_((()=>a.value),(()=>{!a.column.filterOptions||"date-range"!==a.column.filterOptions.type&&"datetime-range"!==a.column.filterOptions.type?r.value=a.value:f.isEmpty(a.value)||2!==a.value.length||f.isEmpty(a.value[0])||f.isEmpty(a.value[1])?i.value=[]:i.value=[y(a.value[0]),y(a.value[1])]})),b();const s=t,i=O([]),r=O(void 0);function u(e,t){s("change",{type:a.column.filterOptions.type,key:a.column.filterOptions.key||a.column.dataIndex,value:[t[0],t[1]],search:!0})}function d(e){let t=!0;"no-search"===e&&(t=!1),s("update:value",r.value),s("change",{type:a.column.filterOptions.type,key:a.column.filterOptions.key||a.column.dataIndex,value:r.value,search:t})}function c(){s("change",{search:!0})}return x((()=>{!a.column.filterOptions||"date-range"!==a.column.filterOptions.type&&"datetime-range"!==a.column.filterOptions.type?r.value=a.value:f.isEmpty(a.value)||2!==a.value.length||f.isEmpty(a.value[0])||f.isEmpty(a.value[1])?i.value=[]:i.value=[y(a.value[0]),y(a.value[1])]})),(t,a)=>{const o=k("a-input-search"),s=k("a-range-picker"),p=k("a-button");return S(),w("div",H,[j("div",K,[C(t.$slots,"title",{},(()=>[I(E(e.column.title),1)]),!0)]),j("div",$,[C(t.$slots,"default",{},(()=>{return[e.column.filterOptions?(S(),w(D,{key:0},["input"===e.column.filterOptions.type?(S(),T(o,{key:0,onChange:a[0]||(a[0]=e=>d("no-search")),value:r.value,"onUpdate:value":a[1]||(a[1]=e=>r.value=e),allowClear:"",placeholder:e.column.placeholder||e.column.title,onSearch:d},null,8,["value","placeholder"])):"date-range"===e.column.filterOptions.type?(S(),T(s,{key:1,value:i.value,"onUpdate:value":a[2]||(a[2]=e=>i.value=e),ranges:e.column.filterOptions.ranges?U(g):[],style:{width:"100%"},onChange:u},null,8,["value","ranges"])):"datetime-range"===e.column.filterOptions.type?(S(),T(s,{key:2,"show-time":"",value:i.value,"onUpdate:value":a[3]||(a[3]=e=>i.value=e),ranges:e.column.filterOptions.ranges?U(g):[],style:{width:"100%"},onChange:u},null,8,["value","ranges"])):"month"===e.column.filterOptions.type?(S(),T(s,{key:3,value:i.value,"onUpdate:value":a[4]||(a[4]=e=>i.value=e),picker:"month",onChange:u},null,8,["value"])):"submit"===e.column.filterOptions.type?(S(),w("div",W,[L(p,{type:e.column.filterOptions.btnType,onClick:c},{default:q((()=>[I("查询")])),_:1},8,["type"])])):(S(),w(D,{key:5},[U(n).includes(e.column.filterOptions.type)?(S(),T(A((t=e.column.filterOptions.type,l[t])),{key:0,width:"100%",value:r.value,"onUpdate:value":a[5]||(a[5]=e=>r.value=e),multiple:e.column.filterOptions.multiple,dictCode:e.column.filterOptions.dictCode,enumName:e.column.filterOptions.enumName,systemConfigKey:e.column.filterOptions.systemConfigKey,placeholder:e.column.placeholder,leaveFlag:e.column.filterOptions.leaveFlag,categoryType:e.column.filterOptions.categoryType,onChange:d},null,40,["value","multiple","dictCode","enumName","systemConfigKey","placeholder","leaveFlag","categoryType"])):(S(),w("div",B,"未定义的组件类型"))],64))],64)):z("",!0)];var t}),!0)])])}}}),[["__scopeId","data-v-9ab30014"]]),Q=h({__name:"index",props:{dictCode:String,dataValue:[String,Number]},setup(e){const t=e,a=G((()=>s().getDataLabels(t.dictCode,t.dataValue)));return(e,t)=>(S(),w("span",null,E(a.value),1))}}),Z={class:"smart-table-operate-block"},X={class:"smart-table-setting-block"},Y={key:2},ee={key:3},te={key:4},ae={key:5,class:"smart-table-operate"},le={class:"smart-query-table-page"},oe={style:{"text-align":"center",width:"400px",margin:"0 auto"}},ne=j("br",null,null,-1),se=j("br",null,null,-1),ie=j("br",null,null,-1),re=h({__name:"goods-list",setup(o){const n=O([{title:"商品分类",dataIndex:"categoryName",resizable:!0,filterOptions:{type:"category-tree",key:"categoryId",categoryType:i.GOODS.value},width:150},{title:"商品名称",dataIndex:"goodsName",resizable:!0,filterOptions:{type:"input",key:"searchWord"},width:150},{title:"商品状态",dataIndex:"goodsStatus",resizable:!0,filterOptions:{type:"enum-select",enumName:"GOODS_STATUS_ENUM"},width:150},{title:"产地",dataIndex:"place",resizable:!0,filterOptions:{type:"dict-select",dictCode:r.GOODS_PLACE||"GOODS_PLACE"},width:150},{title:"价格",dataIndex:"price",resizable:!0,sorter:!0,width:100},{title:"状态",dataIndex:"shelvesFlag",resizable:!0,sorter:!0,width:80},{title:"备注",dataIndex:"remark",ellipsis:!0,resizable:!0,width:150},{title:"创建时间",dataIndex:"createTime",resizable:!0,width:150},{title:"操作",dataIndex:"action",resizable:!0,fixed:"right",width:100}]),s={categoryId:void 0,searchWord:"",goodsStatus:void 0,place:void 0,shelvesFlag:void 0,goodsType:void 0,pageNum:1,pageSize:10,sortItemList:[]},y=P(f.cloneDeep(s)),g=O(!1),h=O([]),_=O(0);function b(e,t){n.value.forEach((a=>{a.dataIndex===t.dataIndex&&(a.width=Math.floor(e),a.dragAndDropFlag=!0)}))}function C(){let e=y.pageSize;Object.assign(y,f.cloneDeep(s)),y.pageSize=e,N()}function A(){y.pageNum=1,N()}async function N(){g.value=!0;try{let e=await l.queryGoodsList(y);h.value=e.data.list,_.value=e.data.total}catch(e){d.captureError(e)}finally{g.value=!1}}x(N);const G=O();function H(e){G.value.showDrawer(e)}function K(e){V.confirm({title:"提示",content:"确定要删除【"+e.goodsName+"】吗?",okText:"删除",okType:"danger",onOk(){!async function(e){try{c.show(),await l.deleteGoods(e.goodsId),M.success("删除成功"),N()}catch(t){d.captureError(t)}finally{c.hide()}}(e)},cancelText:"取消",onCancel(){}})}const $=O([]);function W(e){$.value=e}function B(){V.confirm({title:"提示",content:"确定要删除选中商品吗?",okText:"删除",okType:"danger",onOk(){!async function(){try{c.show(),await l.batchDelete($.value),M.success("删除成功"),N()}catch(e){d.captureError(e)}finally{c.hide()}}()},cancelText:"取消",onCancel(){}})}const re=O(!1),ue=O([]);function de(){ue.value=[],re.value=!0}function ce(){re.value=!1}function pe(e){const t=ue.value.indexOf(e),a=ue.value.slice();a.splice(t,1),ue.value=a}function me(e){return ue.value=[...ue.value||[],e],!1}function ve(){window.open("https://smartadmin.vip/cdn/%E5%95%86%E5%93%81%E6%A8%A1%E6%9D%BF.xls")}async function fe(){const e=new FormData;ue.value.forEach((t=>{e.append("file",t.originFileObj)})),c.show();try{let t=await l.importGoods(e);M.success(t.msg)}catch(t){d.captureError(t)}finally{c.hide()}}async function ye(){await l.exportGoods()}function ge(e,t,a,{action:l}){if("sort"===l){const{order:e,field:t}=a;let l=t.replace(/([A-Z])/g,"_$1").toLowerCase(),o=y.sortItemList.findIndex((e=>e.column===l));if(-1!==o&&y.sortItemList.splice(o,1),e){let t="ascend"!==e;y.sortItemList.push({column:l,isAsc:t})}N()}}const he=O(0);function _e(){let e=document.querySelector(".ant-form"),t=document.querySelector(".smart-table-btn-block"),a=document.querySelector(".ant-table-cell"),l=document.querySelector(".smart-query-table-page"),o=document.querySelector(".admin-content");setTimeout((()=>{let n=e.offsetHeight+10+24+t.offsetHeight+15+a.offsetHeight+l.offsetHeight+20;he.value=o.offsetHeight-n}),100)}return x((()=>{_e()})),window.addEventListener("resize",f.throttle((()=>{_e()}),1e3)),(l,o)=>{const s=k("a-form-item"),d=k("a-input"),c=k("a-radio-button"),f=k("a-radio-group"),g=k("SearchOutlined"),O=k("a-button"),x=k("ReloadOutlined"),P=k("a-button-group"),V=k("a-row"),M=k("a-form"),_e=k("PlusOutlined"),be=k("DeleteOutlined"),Oe=k("ImportOutlined"),xe=k("ExportOutlined"),ke=k("a-table"),we=k("a-pagination"),Se=k("download-outlined"),je=k("upload-outlined"),Ce=k("a-upload"),Ie=k("a-modal"),Ee=k("a-card"),ze=F("privilege");return S(),w(D,null,[L(M,{class:"smart-query-form"},{default:q((()=>[R((S(),T(V,{class:"smart-query-form-row"},{default:q((()=>[L(s,{label:"商品分类",class:"smart-query-form-item"},{default:q((()=>[L(e,{width:"150px",value:y.categoryId,"onUpdate:value":o[0]||(o[0]=e=>y.categoryId=e),placeholder:"请选择商品分类",categoryType:U(i).GOODS.value},null,8,["value","categoryType"])])),_:1}),L(s,{label:"商品名称",class:"smart-query-form-item"},{default:q((()=>[L(d,{style:{width:"200px"},value:y.searchWord,"onUpdate:value":o[1]||(o[1]=e=>y.searchWord=e),placeholder:"商品名称"},null,8,["value"])])),_:1}),L(s,{label:"产地",name:"place",class:"smart-query-form-item"},{default:q((()=>[L(t,{"dict-code":U(r).GOODS_PLACE,value:y.place,"onUpdate:value":o[2]||(o[2]=e=>y.place=e),width:"120px"},null,8,["dict-code","value"])])),_:1}),L(s,{label:"商品状态",name:"goodsStatus",class:"smart-query-form-item"},{default:q((()=>[L(v,{"enum-name":"GOODS_STATUS_ENUM",value:y.goodsStatus,"onUpdate:value":o[3]||(o[3]=e=>y.goodsStatus=e),width:"160px"},null,8,["value"])])),_:1}),L(s,{label:"快速筛选",class:"smart-query-form-item"},{default:q((()=>[L(f,{value:y.shelvesFlag,"onUpdate:value":o[4]||(o[4]=e=>y.shelvesFlag=e),onChange:A},{default:q((()=>[L(c,{value:void 0},{default:q((()=>[I("全部")])),_:1}),L(c,{value:"true"},{default:q((()=>[I("上架")])),_:1}),L(c,{value:"false"},{default:q((()=>[I("下架")])),_:1})])),_:1},8,["value"])])),_:1}),L(s,{class:"smart-query-form-item"},{default:q((()=>[L(P,null,{default:q((()=>[R((S(),T(O,{type:"primary",onClick:A},{icon:q((()=>[L(g)])),default:q((()=>[I(" 查询 ")])),_:1})),[[ze,"goods:query"]]),R((S(),T(O,{onClick:C},{icon:q((()=>[L(x)])),default:q((()=>[I(" 重置 ")])),_:1})),[[ze,"goods:query"]])])),_:1})])),_:1})])),_:1})),[[ze,"goods:query"]])])),_:1}),L(Ee,{size:"small",bordered:!1,hoverable:!0},{default:q((()=>[L(V,{class:"smart-table-btn-block"},{default:q((()=>[j("div",Z,[R((S(),T(O,{onClick:H,type:"primary"},{icon:q((()=>[L(_e)])),default:q((()=>[I(" 新建 ")])),_:1})),[[ze,"goods:add"]]),R((S(),T(O,{onClick:B,danger:"",disabled:0===$.value.length},{icon:q((()=>[L(be)])),default:q((()=>[I(" 批量删除 ")])),_:1},8,["disabled"])),[[ze,"goods:batchDelete"]]),R((S(),T(O,{onClick:de,type:"primary"},{icon:q((()=>[L(Oe)])),default:q((()=>[I(" 导入 ")])),_:1})),[[ze,"goods:importGoods"]]),R((S(),T(O,{onClick:ye,type:"primary"},{icon:q((()=>[L(xe)])),default:q((()=>[I(" 导出 ")])),_:1})),[[ze,"goods:exportGoods"]])]),j("div",X,[L(p,{modelValue:n.value,"onUpdate:modelValue":o[5]||(o[5]=e=>n.value=e),tableId:U(m).BUSINESS.ERP.GOODS,refresh:N},null,8,["modelValue","tableId"])])])),_:1}),L(ke,{size:"small",dataSource:h.value,columns:n.value,rowKey:"goodsId",scroll:{x:1e3,y:he.value},bordered:"",pagination:!1,showSorterTooltip:!1,"row-selection":{selectedRowKeys:$.value,onChange:W},onChange:ge,onResizeColumn:b},{headerCell:q((({column:e})=>[L(J,{value:y[e.filterOptions?.key||e.dataIndex],"onUpdate:value":t=>y[e.filterOptions?.key||e.dataIndex]=t,column:e,onChange:N},null,8,["value","onUpdate:value","column"])])),bodyCell:q((({text:e,record:t,column:a})=>["goodsName"===a.dataIndex?(S(),w(D,{key:0},[I(E(e),1)],64)):z("",!0),"place"===a.dataIndex?(S(),T(Q,{key:1,"dict-code":U(r).GOODS_PLACE,"data-value":e},null,8,["dict-code","data-value"])):z("",!0),"remark"===a.dataIndex?(S(),w("span",Y,E(e||""),1)):z("",!0),"goodsStatus"===a.dataIndex?(S(),w("span",ee,E(l.$smartEnumPlugin.getDescByValue("GOODS_STATUS_ENUM",e)),1)):z("",!0),"shelvesFlag"===a.dataIndex?(S(),w("span",te,E(e?"上架":"下架"),1)):z("",!0),"action"===a.dataIndex?(S(),w("div",ae,[R((S(),T(O,{onClick:e=>H(t),type:"link"},{default:q((()=>[I("编辑")])),_:2},1032,["onClick"])),[[ze,"goods:update"]]),R((S(),T(O,{onClick:e=>K(t),danger:"",type:"link"},{default:q((()=>[I("删除")])),_:2},1032,["onClick"])),[[ze,"goods:delete"]])])):z("",!0)])),_:1},8,["dataSource","columns","scroll","row-selection"]),j("div",le,[L(we,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:U(u),defaultPageSize:y.pageSize,current:y.pageNum,"onUpdate:current":o[6]||(o[6]=e=>y.pageNum=e),pageSize:y.pageSize,"onUpdate:pageSize":o[7]||(o[7]=e=>y.pageSize=e),total:_.value,onChange:N,onShowSizeChange:N,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),L(a,{ref_key:"formModal",ref:G,onReloadList:N},null,512),L(Ie,{open:re.value,"onUpdate:open":o[9]||(o[9]=e=>re.value=e),title:"导入",onOnCancel:ce,onOk:ce},{default:q((()=>[j("div",oe,[L(O,{onClick:ve},{default:q((()=>[L(Se),I("第一步：下载模板")])),_:1}),ne,se,L(Ce,{fileList:ue.value,"onUpdate:fileList":o[8]||(o[8]=e=>ue.value=e),name:"file",multiple:!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",accept:".xls,.xlsx","before-upload":me,onRemove:pe},{default:q((()=>[L(O,null,{default:q((()=>[L(je),I(" 第二步：选择文件 ")])),_:1})])),_:1},8,["fileList"]),ie,L(O,{onClick:fe},{default:q((()=>[L(Oe),I(" 第三步：开始导入 ")])),_:1})])])),_:1},8,["open"])])),_:1})],64)}}});export{re as default};
