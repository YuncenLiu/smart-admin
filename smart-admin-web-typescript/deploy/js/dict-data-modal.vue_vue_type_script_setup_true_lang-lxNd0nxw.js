import{_ as a}from"./dict-data-form-modal.vue_vue_type_script_setup_true_lang-cVlB4BaB.js";import{l as e,s as t,S as l}from"./index-CBkxY9s9.js";import{_ as d}from"./index.vue_vue_type_script_setup_true_lang-CCEjUz2j.js";import{_ as o}from"./lodash-2VbGH-WW.js";import{b as n,M as s}from"./ant-design-vue-CcohkicM.js";import{d as i,r as u,a as r,b2 as c,z as v,ag as m,o as p,bz as f,c as h,ai as y,J as b,y as _,ah as w,be as g}from"./@vue-BVvo-xZd.js";const k={class:"smart-table-operate-block"},C=y("div",{class:"smart-table-setting-block"},null,-1),x={class:"smart-query-table-page"},D=i({__name:"dict-data-modal",setup(i,{expose:D}){const I=u(!1),L=u(void 0),q=u(void 0);function j(){I.value=!1,L.value=void 0,q.value=void 0}const F=r([{title:"值",dataIndex:"dataValue"},{title:"名称",dataIndex:"dataLabel"},{title:"状态",width:90,dataIndex:"disabledFlag"},{title:"排序",width:50,dataIndex:"sortOrder"},{title:"备注",width:200,ellipsis:!0,dataIndex:"remark"},{title:"更新时间",width:150,dataIndex:"updateTime"},{title:"操作",width:70,dataIndex:"action"}]),O=u(void 0),M=u(null),R=u([]),S=u(!1),T=u([]),U=u([]);function z(a){R.value=a}function E(){U.value=T.value.filter((a=>{let e=!0;return O.value&&(e=o.includes(a.dataValue.toLowerCase(),O.value.toLowerCase())||o.includes(a.dataLabel.toLowerCase(),O.value.toLowerCase())||o.includes(a.remark.toLowerCase(),O.value.toLowerCase())),(!!o.isNull(M.value)||a.disabledFlag===M.value)&&e}))}function K(){O.value=null,M.value=null,V()}async function V(){try{S.value=!0;let a=await e.queryDictData(L.value);a.data.map((a=>a.enabled=!a.disabledFlag)),T.value=a.data,E()}catch(a){t.captureError(a)}finally{S.value=!1}}function B(){s.confirm({title:"提示",content:"确定要删除选中值吗?",okText:"删除",okType:"danger",onOk(){!async function(){try{l.show(),await e.batchDeleteDictData(R.value),n.success("删除成功"),await V()}catch(a){t.captureError(a)}finally{l.hide()}}()},cancelText:"取消",onCancel(){}})}const J=u();function N(a){J.value.showModal(a,L.value,q.value)}return D({showModal:function(a,e){L.value=a,q.value=e,I.value=!0,V()}}),(o,s)=>{const i=c("a-input"),u=c("a-form-item"),r=c("SearchOutlined"),D=c("a-button"),L=c("ReloadOutlined"),q=c("a-row"),S=c("a-form"),T=c("PlusOutlined"),P=c("DeleteOutlined"),A=c("a-switch"),G=c("a-table"),H=c("a-drawer"),Q=v("privilege");return p(),m(H,{width:1e3,open:I.value,"body-style":{paddingBottom:"80px"},title:"字典值",onClose:j},{default:f((()=>[h(S,{class:"smart-query-form"},{default:f((()=>[h(q,{class:"smart-query-form-row"},{default:f((()=>[h(u,{label:"关键字",class:"smart-query-form-item"},{default:f((()=>[h(i,{style:{width:"300px"},value:O.value,"onUpdate:value":s[0]||(s[0]=a=>O.value=a),onChange:E,placeholder:"关键字"},null,8,["value"])])),_:1}),h(u,{label:"禁用",class:"smart-query-form-item"},{default:f((()=>[h(d,{value:M.value,"onUpdate:value":s[1]||(s[1]=a=>M.value=a),onChange:E,style:{width:"150px"}},null,8,["value"])])),_:1}),h(u,{class:"smart-query-form-item smart-margin-left10"},{default:f((()=>[h(D,{type:"primary",onClick:V},{icon:f((()=>[h(r)])),default:f((()=>[b(" 查询 ")])),_:1}),h(D,{onClick:K,class:"smart-margin-left10"},{icon:f((()=>[h(L)])),default:f((()=>[b(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1}),h(q,{class:"smart-table-btn-block"},{default:f((()=>[y("div",k,[_((p(),m(D,{onClick:N,type:"primary"},{icon:f((()=>[h(T)])),default:f((()=>[b(" 新建 ")])),_:1})),[[Q,"support:dictData:add"]]),_((p(),m(D,{onClick:B,type:"primary",danger:"",disabled:0===R.value.length},{icon:f((()=>[h(P)])),default:f((()=>[b(" 批量删除 ")])),_:1},8,["disabled"])),[[Q,"support:dictData:delete"]])]),C])),_:1}),h(G,{size:"small",dataSource:U.value,columns:F,rowKey:"dictDataId",pagination:!1,"row-selection":{selectedRowKeys:R.value,onChange:z},bordered:""},{bodyCell:f((({record:a,column:d})=>["disabledFlag"===d.dataIndex?(p(),m(A,{key:0,onChange:d=>async function(a,d){l.show();try{await e.updateDictDataDisabled(d.dictDataId),d.disabledFlag=!a,n.success("操作成功")}catch(o){t.captureError(o)}finally{l.hide()}}(d,a),checked:a.enabled,"onUpdate:checked":e=>a.enabled=e,"checked-children":"启用中","un-checked-children":"已禁用"},null,8,["onChange","checked","onUpdate:checked"])):w("",!0),"action"===d.dataIndex?_((p(),m(D,{key:1,onClick:e=>N(a),type:"link"},{default:f((()=>[b("编辑")])),_:2},1032,["onClick"])),[[Q,"support:dictData:update"]]):w("",!0)])),_:1},8,["dataSource","columns","row-selection"]),y("div",x,"共计 "+g(U.value.length)+" 条",1),h(a,{ref_key:"dictDataFormModalRef",ref:J,onReloadList:V},null,512)])),_:1},8,["open"])}}});export{D as _};
