import{r as e,d as a,a as t,e as l,m as s,b2 as n,z as o,b as r,o as i,c as u,bz as m,y as d,J as p,be as c,E as y,ai as f,ag as v,u as _,K as g,ah as b,b3 as j}from"./@vue-BVvo-xZd.js";import{_ as E}from"./lodash-2VbGH-WW.js";import h from"./menu-operate-modal-BdRZP2C5.js";import{f as k,b as x}from"./menu-data-handler-CNHihdmH.js";import{m as M}from"./menu-api-59Sr21sk.js";import{_ as U}from"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import{s as w,M as I,S as N}from"./index-CBkxY9s9.js";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{T}from"./table-id-const-DES3cCFe.js";import{M as C,b as P}from"./ant-design-vue-CcohkicM.js";import{E as B}from"./@ant-design-D2dl84QQ.js";import"./menu-tree-select.vue_vue_type_script_setup_true_lang-DmbFBLRP.js";import"./index-DKHPqhkv.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./sortablejs-CRp0PNdb.js";const D=e([{title:"名称",dataIndex:"menuName",key:"ID",width:220},{title:"类型",dataIndex:"menuType",width:100,align:"center"},{title:"图标",dataIndex:"icon",width:50},{title:"路径",dataIndex:"path",ellipsis:!0},{title:"组件",dataIndex:"component",ellipsis:!0},{title:"后端权限",dataIndex:"apiPerms",ellipsis:!0},{title:"前端权限",dataIndex:"webPerms",ellipsis:!0},{title:"顺序",dataIndex:"sort",width:80},{title:"操作",dataIndex:"operate",width:170,align:"center"}]),R={class:"smart-table-operate-block"},A={class:"smart-table-setting-block"},O={key:1},q={key:2},L={key:3},G={key:4},S={key:5},V={key:6},z={key:8,class:"smart-table-operate"},$=a({__name:"menu-list",setup(a){const $=["red","blue","orange","green"],Y={keywords:"",menuType:void 0,frameFlag:void 0,cacheFlag:void 0,visibleFlag:void 0,disabledFlag:void 0},K=t({...Y}),J=e(!0),H=e(!1),Q=e([]);function W(){Object.assign(K,Y),X()}async function X(){try{H.value=!0;let e=await M.queryMenu();const a=k(e.data,K);Q.value=x(a)}catch(e){w.captureError(e)}finally{H.value=!1}}l(X);const Z=e([]);let ee=[];const ae=s((()=>Z.value.length>0));function te(e,a){Z.value=e,ee=a}function le(){se(ee)}function se(e){const a=e.map((e=>e.menuName));C.confirm({title:"确定要删除如下菜单吗?",icon:u(B),content:E.join(a,"、"),okText:"删除",okType:"danger",onOk(){!async function(e){N.show();try{await M.batchDeleteMenu(e),P.success("删除成功!"),X()}catch(a){w.captureError(a)}finally{N.hide()}}(e.map((e=>e.menuId))),ee=[]},cancelText:"取消",onCancel(){}})}const ne=e();function oe(e){ne.value.showDrawer(e)}return(e,a)=>{const t=n("a-input"),l=n("a-form-item"),s=n("SearchOutlined"),E=n("a-button"),k=n("ReloadOutlined"),x=n("a-button-group"),M=n("MoreOutlined"),w=n("a-row"),N=n("a-form"),C=n("PlusOutlined"),P=n("DeleteOutlined"),B=n("a-tag"),Y=n("a-table"),ee=n("a-card"),re=o("privilege");return i(),r("div",null,[u(N,{class:"smart-query-form"},{default:m((()=>[u(w,{class:"smart-query-form-row"},{default:m((()=>[u(l,{label:"关键字",class:"smart-query-form-item"},{default:m((()=>[u(t,{style:{width:"300px"},value:K.keywords,"onUpdate:value":a[0]||(a[0]=e=>K.keywords=e),placeholder:"菜单名称/路由地址/组件路径/权限字符串"},null,8,["value"])])),_:1}),u(l,{label:"类型",class:"smart-query-form-item"},{default:m((()=>[u(U,{width:"120px",value:K.menuType,"onUpdate:value":a[1]||(a[1]=e=>K.menuType=e),placeholder:"请选择类型","enum-name":"MENU_TYPE_ENUM"},null,8,["value"])])),_:1}),u(l,{label:"禁用",class:"smart-query-form-item"},{default:m((()=>[u(U,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:K.disabledFlag,"onUpdate:value":a[2]||(a[2]=e=>K.disabledFlag=e)},null,8,["value"])])),_:1}),u(l,{class:"smart-query-form-item smart-margin-left10"},{default:m((()=>[u(x,null,{default:m((()=>[u(E,{type:"primary",onClick:X},{icon:m((()=>[u(s)])),default:m((()=>[p(" 查询 ")])),_:1}),u(E,{onClick:W},{icon:m((()=>[u(k)])),default:m((()=>[p(" 重置 ")])),_:1})])),_:1}),u(E,{class:"smart-margin-left20",onClick:a[3]||(a[3]=e=>J.value=!J.value)},{icon:m((()=>[u(M)])),default:m((()=>[p(" "+c(J.value?"收起":"展开"),1)])),_:1})])),_:1})])),_:1}),d(u(w,{class:"smart-query-form-row"},{default:m((()=>[u(l,{label:"外链",class:"smart-query-form-item"},{default:m((()=>[u(U,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:K.frameFlag,"onUpdate:value":a[4]||(a[4]=e=>K.frameFlag=e)},null,8,["value"])])),_:1}),u(l,{label:"缓存",class:"smart-query-form-item"},{default:m((()=>[u(U,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:K.cacheFlag,"onUpdate:value":a[5]||(a[5]=e=>K.cacheFlag=e)},null,8,["value"])])),_:1}),u(l,{label:"显示",class:"smart-query-form-item"},{default:m((()=>[u(U,{width:"120px","enum-name":"FLAG_NUMBER_ENUM",value:K.visibleFlag,"onUpdate:value":a[6]||(a[6]=e=>K.visibleFlag=e)},null,8,["value"])])),_:1})])),_:1},512),[[y,J.value]])])),_:1}),u(ee,{size:"small",bordered:!1,hoverable:!0},{default:m((()=>[u(w,{class:"smart-table-btn-block"},{default:m((()=>[f("div",R,[d((i(),v(E,{type:"primary",onClick:oe},{icon:m((()=>[u(C)])),default:m((()=>[p(" 添加菜单 ")])),_:1})),[[re,"system:menu:add"]]),d((i(),v(E,{type:"primary",danger:"",onClick:le,disabled:!ae.value},{icon:m((()=>[u(P)])),default:m((()=>[p(" 批量删除 ")])),_:1},8,["disabled"])),[[re,"system:menu:batchDelete"]])]),f("div",A,[u(F,{modelValue:_(D),"onUpdate:modelValue":a[7]||(a[7]=e=>g(D)?D.value=e:null),tableId:_(T).SYSTEM.MENU,refresh:X},null,8,["modelValue","tableId"])])])),_:1}),u(Y,{"row-selection":{selectedRowKeys:Z.value,onChange:te},size:"small",scroll:{y:800},defaultExpandAllRows:!0,dataSource:Q.value,bordered:"",columns:_(D),loading:H.value,rowKey:"menuId",pagination:!1},{bodyCell:m((({text:a,record:t,column:l})=>["menuType"===l.dataIndex?(i(),v(B,{key:0,color:$[a]},{default:m((()=>[p(c(e.$smartEnumPlugin.getDescByValue("MENU_TYPE_ENUM",a)),1)])),_:2},1032,["color"])):b("",!0),"component"===l.dataIndex?(i(),r("span",O,c(t.frameFlag?t.frameUrl:t.component),1)):b("",!0),"frameFlag"===l.dataIndex?(i(),r("span",q,c(e.$smartEnumPlugin.getDescByValue("FLAG_NUMBER_ENUM",a)),1)):b("",!0),"permsType"===l.dataIndex?(i(),r("span",L,c(e.$smartEnumPlugin.getDescByValue("MENU_PERMS_TYPE_ENUM",a)),1)):b("",!0),"cacheFlag"===l.dataIndex?(i(),r("span",G,c(e.$smartEnumPlugin.getDescByValue("FLAG_NUMBER_ENUM",a)),1)):b("",!0),"visibleFlag"===l.dataIndex?(i(),r("span",S,c(e.$smartEnumPlugin.getDescByValue("FLAG_NUMBER_ENUM",a)),1)):b("",!0),"disabledFlag"===l.dataIndex?(i(),r("span",V,c(e.$smartEnumPlugin.getDescByValue("FLAG_NUMBER_ENUM",a)),1)):b("",!0),"icon"===l.dataIndex?(i(),v(j(e.$antIcons[a]),{key:7})):b("",!0),"operate"===l.dataIndex?(i(),r("div",z,[t.menuType!==_(I).POINTS.value?d((i(),v(E,{key:0,type:"link",size:"small",onClick:e=>function(e){const a={parentId:e.menuId,menuType:e.menuType===I.CATALOG.value?I.MENU.value:I.POINTS.value,contextMenuId:e.menuType===I.MENU.value?e.menuId:void 0};ne.value.showDrawer(a)}(t)},{default:m((()=>[p(" 添加下级 ")])),_:2},1032,["onClick"])),[[re,"system:menu:update"]]):b("",!0),d((i(),v(E,{type:"link",size:"small",onClick:e=>oe(t)},{default:m((()=>[p("编辑")])),_:2},1032,["onClick"])),[[re,"system:menu:update"]]),d((i(),v(E,{danger:"",type:"link",onClick:e=>function(e){se([e])}(t)},{default:m((()=>[p("删除")])),_:2},1032,["onClick"])),[[re,"system:menu:batchDelete"]])])):b("",!0)])),_:1},8,["row-selection","dataSource","columns","loading"])])),_:1}),u(h,{ref_key:"menuOperateModal",ref:ne,onReloadList:X},null,512)])}}});export{$ as default};
