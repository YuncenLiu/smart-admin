import{P as e,s as a,S as t}from"./index-CBkxY9s9.js";import{c as l}from"./change-log-api-DwwNqxQO.js";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{_ as o}from"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import{d as s}from"./default-time-ranges-JqpEQ5s5.js";import{_ as r}from"./change-log-modal.vue_vue_type_script_setup_true_lang-CUIDtmJR.js";import{_ as n}from"./change-log-form.vue_vue_type_script_setup_true_lang-DCddoHgg.js";import{M as u,b as p}from"./ant-design-vue-CcohkicM.js";import{d as c,r as d,a as m,e as g,b2 as f,z as v,b as y,o as _,y as h,c as b,ag as j,bz as k,u as w,J as x,ai as z,ah as C,be as S,F as D}from"./@vue-BVvo-xZd.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./lodash-2VbGH-WW.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./sortablejs-CRp0PNdb.js";const I={class:"smart-table-operate-block"},E={class:"smart-table-setting-block"},T={key:2,class:"smart-table-operate"},O={class:"smart-query-table-page"},q=c({__name:"change-log-list",setup(c){const q=d([{title:"版本",dataIndex:"version",ellipsis:!0},{title:"更新类型",dataIndex:"type",ellipsis:!0},{title:"发布人",dataIndex:"publishAuthor",ellipsis:!0},{title:"发布日期",dataIndex:"publicDate",ellipsis:!0},{title:"更新内容",dataIndex:"content",ellipsis:!0},{title:"跳转链接",dataIndex:"link",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",ellipsis:!0},{title:"更新时间",dataIndex:"updateTime",ellipsis:!0},{title:"操作",dataIndex:"action",fixed:"right",width:90}]),L={type:void 0,keyword:void 0,publicDate:[],publicDateBegin:void 0,publicDateEnd:void 0,createTime:void 0,link:void 0,pageNum:1,pageSize:10},N=m({...L}),P=d(!1),U=d([]),Y=d(0);function G(){let e=N.pageSize;Object.assign(N,L),N.pageSize=e,R()}function M(){N.pageNum=1,R()}async function R(){P.value=!0;try{let e=await l.queryPage(N);U.value=e.data.list,Y.value=e.data.total}catch(e){a.captureError(e)}finally{P.value=!1}}function A(e,a){N.publicDateBegin=a[0],N.publicDateEnd=a[1]}g(R);const V=d();const B=d();function F(e){B.value.show(e)}function H(e){u.confirm({title:"提示",content:"确定要删除选吗?",okText:"删除",okType:"danger",onOk(){!async function(e){t.show();try{await l.delete(e.changeLogId),p.success("删除成功"),R()}catch(i){a.captureError(i)}finally{t.hide()}}(e)},cancelText:"取消",onCancel(){}})}const J=d([]);function K(e){J.value=e}function $(){u.confirm({title:"提示",content:"确定要批量删除这些数据吗?",okText:"删除",okType:"danger",onOk(){!async function(){try{t.show(),await l.batchDelete(J.value),p.success("删除成功"),R()}catch(e){a.captureError(e)}finally{t.hide()}}()},cancelText:"取消",onCancel(){}})}return(a,t)=>{const l=f("a-form-item"),u=f("a-input"),p=f("a-range-picker"),c=f("a-date-picker"),d=f("SearchOutlined"),m=f("a-button"),g=f("ReloadOutlined"),L=f("a-button-group"),P=f("a-row"),Q=f("a-form"),W=f("PlusOutlined"),X=f("DeleteOutlined"),Z=f("check-circle-outlined"),ee=f("a-tag"),ae=f("a-table"),te=f("a-pagination"),le=f("a-card"),ie=v("privilege");return _(),y(D,null,[h((_(),j(Q,{class:"smart-query-form"},{default:k((()=>[b(P,{class:"smart-query-form-row"},{default:k((()=>[b(l,{label:"更新类型",class:"smart-query-form-item"},{default:k((()=>[b(o,{width:"200px",value:N.type,"onUpdate:value":t[0]||(t[0]=e=>N.type=e),enumName:"CHANGE_LOG_TYPE_ENUM",placeholder:"更新类型"},null,8,["value"])])),_:1}),b(l,{label:"关键字",class:"smart-query-form-item"},{default:k((()=>[b(u,{style:{width:"200px"},value:N.keyword,"onUpdate:value":t[1]||(t[1]=e=>N.keyword=e),placeholder:"关键字"},null,8,["value"])])),_:1}),b(l,{label:"发布日期",class:"smart-query-form-item"},{default:k((()=>[b(p,{value:N.publicDate,"onUpdate:value":t[2]||(t[2]=e=>N.publicDate=e),presets:w(s),style:{width:"240px"},onChange:A},null,8,["value","presets"])])),_:1}),b(l,{label:"创建时间",class:"smart-query-form-item"},{default:k((()=>[b(c,{valueFormat:"YYYY-MM-DD",value:N.createTime,"onUpdate:value":t[3]||(t[3]=e=>N.createTime=e),style:{width:"150px"}},null,8,["value"])])),_:1}),b(l,{class:"smart-query-form-item"},{default:k((()=>[b(L,null,{default:k((()=>[b(m,{type:"primary",onClick:M},{icon:k((()=>[b(d)])),default:k((()=>[x(" 查询 ")])),_:1}),b(m,{onClick:G,class:"smart-margin-left10"},{icon:k((()=>[b(g)])),default:k((()=>[x(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[ie,"support:changeLog:query"]]),b(le,{size:"small",bordered:!1,hoverable:!0},{default:k((()=>[b(P,{class:"smart-table-btn-block"},{default:k((()=>[z("div",I,[h((_(),j(m,{onClick:F,type:"primary"},{icon:k((()=>[b(W)])),default:k((()=>[x(" 新建 ")])),_:1})),[[ie,"support:changeLog:add"]]),h((_(),j(m,{onClick:$,danger:"",disabled:0===J.value.length},{icon:k((()=>[b(X)])),default:k((()=>[x(" 批量删除 ")])),_:1},8,["disabled"])),[[ie,"support:changeLog:batchDelete"]])]),z("div",E,[b(i,{modelValue:q.value,"onUpdate:modelValue":t[4]||(t[4]=e=>q.value=e),tableId:null,refresh:R},null,8,["modelValue"])])])),_:1}),b(ae,{size:"small",dataSource:U.value,columns:q.value,rowKey:"changeLogId",bordered:"",pagination:!1,"row-selection":{selectedRowKeys:J.value,onChange:K}},{bodyCell:k((({text:e,record:t,column:l})=>["version"===l.dataIndex?(_(),j(m,{key:0,onClick:e=>{return a=t,void V.value.show(a);var a},type:"link"},{default:k((()=>[x(S(e),1)])),_:2},1032,["onClick"])):C("",!0),"type"===l.dataIndex?(_(),j(ee,{key:1,color:"success"},{icon:k((()=>[b(Z)])),default:k((()=>[x(" "+S(a.$smartEnumPlugin.getDescByValue("CHANGE_LOG_TYPE_ENUM",e)),1)])),_:2},1024)):C("",!0),"action"===l.dataIndex?(_(),y("div",T,[h((_(),j(m,{onClick:e=>F(t),type:"link"},{default:k((()=>[x("编辑")])),_:2},1032,["onClick"])),[[ie,"support:changeLog:update"]]),h((_(),j(m,{onClick:e=>H(t),danger:"",type:"link"},{default:k((()=>[x("删除")])),_:2},1032,["onClick"])),[[ie,"support:changeLog:delete"]])])):C("",!0)])),_:1},8,["dataSource","columns","row-selection"]),z("div",O,[b(te,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:w(e),defaultPageSize:N.pageSize,current:N.pageNum,"onUpdate:current":t[5]||(t[5]=e=>N.pageNum=e),pageSize:N.pageSize,"onUpdate:pageSize":t[6]||(t[6]=e=>N.pageSize=e),total:Y.value,onChange:R,onShowSizeChange:R,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])]),b(n,{ref_key:"formRef",ref:B,onReloadList:R},null,512),b(r,{ref_key:"modalRef",ref:V},null,512)])),_:1})],64)}}});export{q as default};
