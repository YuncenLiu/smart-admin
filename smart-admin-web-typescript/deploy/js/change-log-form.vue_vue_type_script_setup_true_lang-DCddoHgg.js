import{_ as e}from"./lodash-2VbGH-WW.js";import{S as a,s as l}from"./index-CBkxY9s9.js";import{c as t}from"./change-log-api-DwwNqxQO.js";import{_ as o}from"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import{b as s}from"./ant-design-vue-CcohkicM.js";import{d as u,r as n,a as i,b2 as r,ag as d,o as c,bz as p,c as v,u as m,J as h,n as f}from"./@vue-BVvo-xZd.js";const b=u({__name:"change-log-form",emits:["reloadList"],setup(u,{expose:b,emit:_}){const g=_,y=n(!1);function w(){Object.assign(C,k),y.value=!1}const j=n(),k={changeLogId:void 0,version:void 0,type:void 0,publishAuthor:void 0,publicDate:void 0,content:void 0,link:void 0};let C=i({...k});const D={version:[{required:!0,message:"版本 必填"}],type:[{required:!0,message:"更新类型:[1:特大版本功能更新;2:功能更新;3:bug修复] 必填"}],publishAuthor:[{required:!0,message:"发布人 必填"}],publicDate:[{required:!0,message:"发布日期 必填"}],content:[{required:!0,message:"更新内容 必填"}]};async function U(){try{await j.value.validateFields(),async function(){a.show();try{C.changeLogId?await t.update(C):await t.add(C),s.success("操作成功"),g("reloadList"),w()}catch(e){l.captureError(e)}finally{a.hide()}}()}catch(e){s.error("参数验证错误，请仔细填写表单数据!")}}return b({show:function(a){Object.assign(C,k),a&&!e.isEmpty(a)&&Object.assign(C,a),y.value=!0,f((()=>{j.value.clearValidate()}))}}),(e,a)=>{const l=r("a-input"),t=r("a-form-item"),s=r("a-date-picker"),u=r("a-textarea"),n=r("a-form"),i=r("a-button"),f=r("a-space"),b=r("a-modal");return c(),d(b,{title:m(C).changeLogId?"编辑":"添加",width:"600px",closable:!0,open:y.value,onClose:w,onCancel:w,maskClosable:!1,destroyOnClose:!0},{footer:p((()=>[v(f,null,{default:p((()=>[v(i,{onClick:w},{default:p((()=>[h("取消")])),_:1}),v(i,{type:"primary",onClick:U},{default:p((()=>[h("保存")])),_:1})])),_:1})])),default:p((()=>[v(n,{ref_key:"formRef",ref:j,model:m(C),rules:D,"label-col":{span:5}},{default:p((()=>[v(t,{label:"版本",name:"version"},{default:p((()=>[v(l,{style:{width:"100%"},value:m(C).version,"onUpdate:value":a[0]||(a[0]=e=>m(C).version=e),placeholder:"版本"},null,8,["value"])])),_:1}),v(t,{label:"更新类型",name:"type"},{default:p((()=>[v(o,{width:"100%",value:m(C).type,"onUpdate:value":a[1]||(a[1]=e=>m(C).type=e),enumName:"CHANGE_LOG_TYPE_ENUM",placeholder:"更新类型"},null,8,["value"])])),_:1}),v(t,{label:"发布人",name:"publishAuthor"},{default:p((()=>[v(l,{style:{width:"100%"},value:m(C).publishAuthor,"onUpdate:value":a[2]||(a[2]=e=>m(C).publishAuthor=e),placeholder:"发布人"},null,8,["value"])])),_:1}),v(t,{label:"发布日期",name:"publicDate"},{default:p((()=>[v(s,{valueFormat:"YYYY-MM-DD",value:m(C).publicDate,"onUpdate:value":a[3]||(a[3]=e=>m(C).publicDate=e),style:{width:"100%"},placeholder:"发布日期"},null,8,["value"])])),_:1}),v(t,{label:"跳转链接",name:"link"},{default:p((()=>[v(l,{style:{width:"100%"},value:m(C).link,"onUpdate:value":a[4]||(a[4]=e=>m(C).link=e),placeholder:"跳转链接"},null,8,["value"])])),_:1}),v(t,{label:"更新内容",name:"content"},{default:p((()=>[v(u,{style:{width:"100%"},rows:15,value:m(C).content,"onUpdate:value":a[5]||(a[5]=e=>m(C).content=e),placeholder:"更新内容"},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","open"])}}});export{b as _};
