import{d as e,a as t,r as a,e as l,b2 as i,z as o,b as s,o as r,y as n,c as d,ag as u,bz as c,F as p,b0 as m,J as f,be as v,u as y,ai as g,ah as h,E as b}from"./@vue-BVvo-xZd.js";import{u as j}from"./vue-router-D-yLC68c.js";import{c as _,s as w,P as x}from"./index-CBkxY9s9.js";import{_ as I}from"./index.vue_vue_type_script_setup_true_lang-CCEjUz2j.js";import{n as k}from"./notice-api-BS5_b2B9.js";import N from"./notice-form-drawer-D7OAKYr4.js";import{d as S}from"./default-time-ranges-JqpEQ5s5.js";import{_ as C}from"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import{T}from"./table-id-const-DES3cCFe.js";import{M as z,b as U}from"./ant-design-vue-CcohkicM.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./lodash-2VbGH-WW.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./index-DwfIiKZa.js";import"./@wangeditor-next-CoIDXbIU.js";import"./notice-form-visible-modal.vue_vue_type_script_setup_true_lang-Qy6bjgrV.js";import"./notice-form-visible-transfer-department-BXYZI4in.js";import"./department-api-Dth9G_6l.js";import"./notice-form-visible-transfer-employee-B5ZDBDwx.js";import"./sortablejs-CRp0PNdb.js";const q={class:"smart-table-operate-block"},F={class:"smart-table-setting-block"},E=["onClick"],O={key:0,class:"smart-table-operate"},V={class:"smart-query-table-page"},B=e({__name:"notice-list",setup(e){const B={noticeTypeId:void 0,keywords:"",documentNumber:"",createUserName:void 0,deletedFlag:void 0,createTimeBegin:null,createTimeEnd:null,publishTimeBegin:null,publishTimeEnd:null,pageNum:1,pageSize:_},P=t({...B}),A=a([{title:"标题",dataIndex:"title",width:300,ellipsis:!0},{title:"文号",dataIndex:"documentNumber",width:100,ellipsis:!0},{title:"分类",dataIndex:"noticeTypeName",width:60,ellipsis:!0},{title:"作者",dataIndex:"author",width:80,ellipsis:!0},{title:"来源",dataIndex:"source",width:90,ellipsis:!0},{title:"可见范围",dataIndex:"allVisibleFlag",width:90,ellipsis:!0},{title:"发布状态",dataIndex:"publishFlag",width:80},{title:"删除",dataIndex:"deletedFlag",width:80},{title:"发布时间",dataIndex:"publishTime",width:150},{title:"页面浏览量",dataIndex:"pageViewCount",width:90},{title:"用户浏览量",dataIndex:"userViewCount",width:90},{title:"创建人",dataIndex:"createUserName",width:80},{title:"创建时间",dataIndex:"createTime",width:150},{title:"操作",dataIndex:"action",fixed:"right",width:90}]),D=a([]);const J=a([]),L=a(0),M=a(!1);async function R(){try{M.value=!0;const e=await k.queryNotice(P);J.value=e.data.list,L.value=e.data.total}catch(e){w.captureError(e)}finally{M.value=!1}}function K(){P.pageNum=1,R()}function Q(){Object.assign(P,B),Y.value=[],G.value=[],R()}l((()=>{!async function(){try{const e=await k.getAllNoticeTypeList();D.value=e.data}catch(e){w.captureError(e)}}(),R()}));const Y=a([]);function $(e,t){P.publishTimeBegin=t[0],P.publishTimeEnd=t[1]}const G=a([]);function H(e,t){P.createTimeBegin=t[0],P.createTimeEnd=t[1]}const W=a();function X(e){W.value.showModal(e)}function Z(e){z.confirm({title:"提示",content:"确认删除此数据吗?",onOk(){!async function(e){try{M.value=!0,await k.deleteNotice(e),U.success("删除成功"),R()}catch(t){w.captureError(t)}finally{M.value=!1}}(e)}})}const ee=j();return(e,t)=>{const a=i("a-select-option"),l=i("a-select"),j=i("a-form-item"),_=i("a-input"),w=i("a-range-picker"),k=i("SearchOutlined"),z=i("a-button"),U=i("ReloadOutlined"),B=i("a-button-group"),te=i("a-row"),ae=i("a-form"),le=i("PlusOutlined"),ie=i("a-tag"),oe=i("a-table"),se=i("a-pagination"),re=i("a-card"),ne=o("privilege");return r(),s(p,null,[n((r(),u(ae,{class:"smart-query-form"},{default:c((()=>[d(te,{class:"smart-query-form-row"},{default:c((()=>[d(j,{label:"分类",class:"smart-query-form-item"},{default:c((()=>[d(l,{value:P.noticeTypeId,"onUpdate:value":t[0]||(t[0]=e=>P.noticeTypeId=e),style:{width:"100px"},showSearch:!0,allowClear:!0,placeholder:"分类"},{default:c((()=>[(r(!0),s(p,null,m(D.value,(e=>(r(),u(a,{key:e.noticeTypeId,value:e.noticeTypeId},{default:c((()=>[f(v(e.noticeTypeName),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),d(j,{label:"关键字",class:"smart-query-form-item"},{default:c((()=>[d(_,{style:{width:"300px"},value:P.keywords,"onUpdate:value":t[1]||(t[1]=e=>P.keywords=e),placeholder:"标题、作者、来源"},null,8,["value"])])),_:1}),d(j,{label:"文号",class:"smart-query-form-item"},{default:c((()=>[d(_,{style:{width:"150px"},value:P.documentNumber,"onUpdate:value":t[2]||(t[2]=e=>P.documentNumber=e),placeholder:"文号"},null,8,["value"])])),_:1}),d(j,{label:"创建人",class:"smart-query-form-item"},{default:c((()=>[d(_,{style:{width:"100px"},value:P.createUserName,"onUpdate:value":t[3]||(t[3]=e=>P.createUserName=e),placeholder:"创建人"},null,8,["value"])])),_:1}),d(j,{label:"是否删除",class:"smart-query-form-item"},{default:c((()=>[d(I,{value:P.deletedFlag,"onUpdate:value":t[4]||(t[4]=e=>P.deletedFlag=e),style:{width:"70px"}},null,8,["value"])])),_:1}),d(j,{label:"发布时间",class:"smart-query-form-item"},{default:c((()=>[d(w,{value:Y.value,"onUpdate:value":t[5]||(t[5]=e=>Y.value=e),presets:y(S),onChange:$,style:{width:"220px"}},null,8,["value","presets"])])),_:1}),d(j,{label:"创建时间",class:"smart-query-form-item"},{default:c((()=>[d(w,{value:G.value,"onUpdate:value":t[6]||(t[6]=e=>G.value=e),presets:y(S),onChange:H,style:{width:"220px"}},null,8,["value","presets"])])),_:1}),d(j,{class:"smart-query-form-item smart-margin-left10"},{default:c((()=>[d(B,null,{default:c((()=>[d(z,{type:"primary",onClick:K},{icon:c((()=>[d(k)])),default:c((()=>[f(" 查询 ")])),_:1}),d(z,{onClick:Q},{icon:c((()=>[d(U)])),default:c((()=>[f(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})),[[ne,"oa:notice:query"]]),d(re,{size:"small",bordered:!1},{default:c((()=>[d(te,{class:"smart-table-btn-block"},{default:c((()=>[g("div",q,[n((r(),u(z,{type:"primary",onClick:t[7]||(t[7]=e=>X())},{icon:c((()=>[d(le)])),default:c((()=>[f(" 新建 ")])),_:1})),[[ne,"oa:notice:add"]])]),g("div",F,[d(C,{modelValue:A.value,"onUpdate:modelValue":t[8]||(t[8]=e=>A.value=e),tableId:y(T).BUSINESS.OA.NOTICE,refresh:R},null,8,["modelValue","tableId"])])])),_:1}),d(oe,{rowKey:"noticeId",columns:A.value,dataSource:J.value,scroll:{x:1510},pagination:!1,loading:M.value,size:"small",bordered:""},{bodyCell:c((({column:e,record:t,text:a})=>["title"===e.dataIndex?(r(),s("a",{key:0,onClick:e=>{return a=t.noticeId,void ee.push({path:"/oa/notice/notice-detail",query:{noticeId:a}});var a}},v(a),9,E)):h("",!0),"documentNumber"===e.dataIndex?(r(),s(p,{key:1},[f(v(a||"无"),1)],64)):"allVisibleFlag"===e.dataIndex?(r(),s(p,{key:2},[f(v(a?"全部可见":"部分可见"),1)],64)):"publishFlag"===e.dataIndex?(r(),s(p,{key:3},[f(v(a?"已发布":"待发布"),1)],64)):"deletedFlag"===e.dataIndex?(r(),s(p,{key:4},[n(d(ie,{color:"error"},{default:c((()=>[f("已删除")])),_:2},1536),[[b,a]]),n(d(ie,{color:"success"},{default:c((()=>[f("未删除")])),_:2},1536),[[b,!a]])],64)):"action"===e.dataIndex?(r(),s(p,{key:5},[t.deletedFlag?h("",!0):(r(),s("div",O,[n((r(),u(z,{type:"link",onClick:e=>X(t.noticeId)},{default:c((()=>[f("编辑")])),_:2},1032,["onClick"])),[[ne,"oa:notice:update"]]),n((r(),u(z,{type:"link",onClick:e=>Z(t.noticeId),danger:""},{default:c((()=>[f("删除")])),_:2},1032,["onClick"])),[[ne,"oa:notice:delete"]])]))],64)):h("",!0)])),_:1},8,["columns","dataSource","loading"]),g("div",V,[d(se,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:y(x),defaultPageSize:P.pageSize,current:P.pageNum,"onUpdate:current":t[9]||(t[9]=e=>P.pageNum=e),pageSize:P.pageSize,"onUpdate:pageSize":t[10]||(t[10]=e=>P.pageSize=e),total:L.value,onChange:R,onShowSizeChange:R,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1}),d(N,{ref_key:"noticeFormDrawer",ref:W,onReloadList:R},null,512)],64)}}});export{B as default};
