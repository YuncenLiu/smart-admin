import{d as e,a,e as l,r as t,b2 as o,b as i,o as r,c as s,ai as n,bz as m,G as u,J as d,F as c}from"./@vue-BVvo-xZd.js";import{p,b as g,S as h,s as f}from"./index-CBkxY9s9.js";import{b,M as w}from"./ant-design-vue-CcohkicM.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./lodash-2VbGH-WW.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const v=()=>g("/support/protect/level3protect/getConfig"),x=e=>p("/support/protect/level3protect/updateConfig",e),M=n("h4",null,"三级等保：",-1),y=n("pre",null,[d("  1.三级等保是中国国家等级保护认证中的最高级别认证，该认证包含了五个等级保护安全技术要求和五个安全管理要求，共涉及测评分类73类，要求非常严格。\n  2.三级等保是地市级以上国家机关、重要企事业单位需要达成的认证，在金融行业中，可以看作是除了银行机构以外最高级别的信息安全等级保护。\n  3.具体三级等保要求，请查看“1024创新实验室”写的相关文档 "),n("a",{href:"https://smartadmin.vip/views/level3protect/basic.html",target:"_blank"},"三级等保文档")],-1),F=n("br",null,null,-1),j=n("br",null,null,-1),k=e({__name:"level3-protect-config-index",setup(e){const n={loginFailMaxTimes:5,loginFailLockMinutes:30,loginActiveTimeoutMinutes:30,passwordComplexityEnabled:!0,regularChangePasswordMonths:3,regularChangePasswordNotAllowRepeatTimes:3,twoFactorLoginEnabled:!0,fileDetectFlag:!0,maxUploadFileSizeMb:50},p={loginFailMaxTimes:0,loginFailLockMinutes:0,loginActiveTimeoutMinutes:0,passwordComplexityEnabled:!1,regularChangePasswordMonths:0,regularChangePasswordNotAllowRepeatTimes:0,twoFactorLoginEnabled:!1,maxUploadFileSizeMb:0},g=a({...n}),k={loginFailMaxTimes:[{required:!0,message:"请输入 最大连续登录失败次数"}],loginFailLockMinutes:[{required:!0,message:"请输入 连续登录失败锁定分钟"}],loginActiveTimeoutMinutes:[{required:!0,message:"请输入 最低活跃时间分钟"}],regularChangePasswordMonths:[{required:!0,message:"请输入 定期修改密码时间间隔"}],regularChangePasswordNotAllowRepeatTimes:[{required:!0,message:"请输入 定期修改密码时间间隔"}],maxUploadFileSizeMb:[{required:!0,message:"请输入 上传文件大小限制"}]};l((async function(){h.show();try{let e=await v();if(!e.data)return void b.warn("当前未配置三级等保");let a=JSON.parse(e.data);g.loginFailMaxTimes=a.loginFailMaxTimes,g.loginFailLockMinutes=a.loginFailLockMinutes,g.loginActiveTimeoutMinutes=a.loginActiveTimeoutMinutes,g.passwordComplexityEnabled=a.passwordComplexityEnabled,g.regularChangePasswordMonths=a.regularChangePasswordMonths,g.regularChangePasswordNotAllowRepeatTimes=a.regularChangePasswordNotAllowRepeatTimes,g.twoFactorLoginEnabled=a.twoFactorLoginEnabled,g.maxUploadFileSizeMb=a.maxUploadFileSizeMb,g.fileDetectFlag=a.fileDetectFlag}catch(e){f.captureError(e)}finally{h.hide()}}));const C=t();function T(){C.value.validate().then(_).catch((e=>{b.error("参数验证错误，请仔细填写表单数据!")}))}async function _(){h.show();try{let e=await x(g);b.success(e.msg)}catch(e){f.captureError(e)}finally{h.hide()}}function U(){Object.assign(g,n),_()}function q(){w.confirm({title:"提示",content:"确定要清除三级等保配置吗?这样系统不安全哦",okText:"清除三级等保配置",okType:"danger",onOk(){Object.assign(g,p),_()},cancelText:"取消",onCancel(){}})}return(e,a)=>{const l=o("a-alert"),t=o("a-switch"),n=o("a-form-item"),p=o("a-input-number"),h=o("a-button"),f=o("a-form"),b=o("a-card");return r(),i(c,null,[s(l,{closable:""},{message:m((()=>[M])),description:m((()=>[y])),_:1}),F,s(b,{title:"三级等保配置"},{default:m((()=>[s(f,{model:g,rules:k,ref_key:"formRef",ref:C,style:{width:"100%"},"label-col":{span:6},"wrapper-col":{span:18},autocomplete:"off",class:"smart-query-form"},{default:m((()=>[s(n,{label:"配置双因子登录模式",class:"smart-query-form-item",extra:"在用户登录时，需要同时提供用户名和密码以及其他形式的身份验证信息，例如短信验证码等"},{default:m((()=>[s(t,{checked:g.twoFactorLoginEnabled,"onUpdate:checked":a[0]||(a[0]=e=>g.twoFactorLoginEnabled=e),"checked-children":"开启 ","un-checked-children":"关闭 "},null,8,["checked"])])),_:1}),s(n,{label:"最大连续登录失败次数",class:"smart-query-form-item",extra:"连续登录失败超过一定次数，则需要锁定；默认5次；0则不锁定；",name:"loginFailMaxTimes"},{default:m((()=>[s(p,{min:0,max:10,value:g.loginFailMaxTimes,"onUpdate:value":a[1]||(a[1]=e=>g.loginFailMaxTimes=e),placeholder:"最大连续登录失败次数","addon-after":"次"},null,8,["value"])])),_:1}),s(n,{name:"loginFailLockMinutes",label:"连续登录失败锁定分钟",class:"smart-query-form-item",extra:"连续登录失败锁定的时间；默认30分钟，0则不锁定"},{default:m((()=>[s(p,{min:0,value:g.loginFailLockMinutes,"onUpdate:value":a[2]||(a[2]=e=>g.loginFailLockMinutes=e),placeholder:"连续登录失败锁定时分钟","addon-after":"分钟"},null,8,["value"])])),_:1}),s(n,{name:"loginActiveTimeoutMinutes",label:"登录后无操作自动退出的分钟",class:"smart-query-form-item",extra:"如：登录1小时没操作自动退出当前登录状态；默认30分钟"},{default:m((()=>[s(p,{min:-1,value:g.loginActiveTimeoutMinutes,"onUpdate:value":a[3]||(a[3]=e=>g.loginActiveTimeoutMinutes=e),placeholder:"登录后无操作自动退出的分钟","addon-after":"分钟"},null,8,["value"])])),_:1}),s(n,{label:"开启密码复杂度",class:"smart-query-form-item",extra:"密码长度为8-20位且必须包含字母、数字、特殊符号（如：@#$%^&*()_+-=）等三种字符"},{default:m((()=>[s(t,{checked:g.passwordComplexityEnabled,"onUpdate:checked":a[4]||(a[4]=e=>g.passwordComplexityEnabled=e),"checked-children":"开启 ","un-checked-children":"关闭 "},null,8,["checked"])])),_:1}),s(n,{name:"regularChangePasswordMonths",label:"定期修改密码时间间隔",class:"smart-query-form-item",extra:"定期修改密码时间间隔，默认3个月"},{default:m((()=>[s(p,{min:-1,max:6,value:g.regularChangePasswordMonths,"onUpdate:value":a[5]||(a[5]=e=>g.regularChangePasswordMonths=e),placeholder:"定期修改密码时间间隔","addon-after":"月"},null,8,["value"])])),_:1}),s(n,{name:"regularChangePasswordNotAllowRepeatTimes",label:"定期修改密码不允许重复次数",class:"smart-query-form-item",extra:"定期修改密码不允许重复次数，默认：3次以内密码不能相同"},{default:m((()=>[s(p,{min:-1,max:6,value:g.regularChangePasswordNotAllowRepeatTimes,"onUpdate:value":a[6]||(a[6]=e=>g.regularChangePasswordNotAllowRepeatTimes=e),placeholder:"相同密码不允许重复次数","addon-after":"次"},null,8,["value"])])),_:1}),s(n,{label:"文件安全检测",class:"smart-query-form-item",extra:"对文件类型、恶意文件进行检测；（具体请看后端： SecurityFileService 类 checkFile 方法 ）"},{default:m((()=>[s(t,{checked:g.fileDetectFlag,"onUpdate:checked":a[7]||(a[7]=e=>g.fileDetectFlag=e),"checked-children":"开启 ","un-checked-children":"关闭 "},null,8,["checked"])])),_:1}),s(n,{name:"maxUploadFileSizeMb",label:"上传文件大小限制",class:"smart-query-form-item",extra:"上传文件大小限制，默认 50 mb ( 0 表示不限制)"},{default:m((()=>[s(p,{min:0,value:g.maxUploadFileSizeMb,"onUpdate:value":a[8]||(a[8]=e=>g.maxUploadFileSizeMb=e),placeholder:"上传文件大小限制","addon-after":"mb(兆)"},null,8,["value"])])),_:1}),j,s(n,{"wrapper-col":{span:14,offset:6}},{default:m((()=>[s(h,{type:"primary",style:{"margin-right":"20px"},onClick:u(T,["prevent"])},{default:m((()=>[d("保存配置")])),_:1}),s(h,{style:{"margin-right":"20px"},onClick:U},{default:m((()=>[d("恢复三级等保默认配置")])),_:1}),s(h,{danger:"",onClick:q},{default:m((()=>[d("清除所有配置")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})],64)}}});export{k as default};
