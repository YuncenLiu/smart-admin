import{d as e,i as a,r as l,b2 as t,b as n,o as u,c as o,bz as s,J as d,ag as m,ah as i,u as r,F as c,b0 as p,y,be as v,E as h,ai as f,n as N}from"./@vue-BVvo-xZd.js";import{S as w}from"./sortablejs-CRp0PNdb.js";import{_ as b}from"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import{q as x}from"./index-CBkxY9s9.js";import{b as g}from"./str-util-DvlP_5eO.js";const _={key:6,class:"smart-table-operate"},I=e({__name:"code-generator-table-config-form-query-field",setup(e,{expose:I}){a("tableInfo");const E=l([{title:"拖拽",dataIndex:"drag",width:60},{title:"查询类型",dataIndex:"queryTypeEnum",width:130},{title:"查询列",dataIndex:"columnNameList"},{title:"条件名称",dataIndex:"label",width:150},{title:"字段命名",dataIndex:"fieldName",width:150},{title:"宽度",dataIndex:"width",width:150},{title:"操作",dataIndex:"operate",width:60}]),C=l([]),L=l([]);let q=1;function k(){C.value.push({rowKey:"rowKey"+q,label:"",fieldName:"",queryTypeEnum:"",columnNameList:null,width:"200px"}),q++}return I({setData:function(e,a){q=1;let l=a&&a.queryFields?a.queryFields:[];for(let t=0;t<l.length;t++)l[t].rowKey="rowKey"+q,q++;C.value=l,L.value=e,N((()=>{!function(){let e=document.querySelector("#smartCodeQueryFieldsTable tbody");w.create(e,{animation:300,dragClass:"smart-ghost-class",ghostClass:"smart-ghost-class",chosenClass:"smart-ghost-class",handle:".handle",onEnd:({oldIndex:e,newIndex:a})=>{const l=C.value.splice(e-1,1)[0];C.value.splice(a-1,0,l)}})}()}))},getFieldsForm:function(){return C.value.map((e=>({label:e.label,width:e.width,fieldName:e.fieldName,queryTypeEnum:e.queryTypeEnum,columnNameList:e.columnNameList&&"string"==typeof e.columnNameList?[e.columnNameList]:e.columnNameList})))}}),(e,a)=>{const l=t("a-button"),w=t("a-row"),I=t("drag-outlined"),q=t("a-input"),U=t("a-select-option"),T=t("a-select"),F=t("a-table");return u(),n(c,null,[o(w,null,{default:s((()=>[o(l,{type:"primary",onClick:k},{default:s((()=>[d("添加查询条件")])),_:1})])),_:1}),o(F,{size:"small",bordered:"",id:"smartCodeQueryFieldsTable",class:"smart-margin-top10",dataSource:C.value,"row-class-name":"column-row",columns:E.value,rowKey:"rowKey",pagination:!1},{bodyCell:s((({record:e,index:a,column:t})=>["drag"===t.dataIndex?(u(),m(l,{key:0,type:"text",class:"handle",size:"small",style:{width:"100%","text-align":"left"}},{icon:s((()=>[o(I)])),_:1})):i("",!0),"label"===t.dataIndex?(u(),m(q,{key:1,value:e.label,"onUpdate:value":a=>e.label=a,placeholder:"关键字查询"},null,8,["value","onUpdate:value"])):i("",!0),"fieldName"===t.dataIndex?(u(),m(q,{key:2,value:e.fieldName,"onUpdate:value":a=>e.fieldName=a,placeholder:"keywords"},null,8,["value","onUpdate:value"])):i("",!0),"width"===t.dataIndex?(u(),m(q,{key:3,value:e.width,"onUpdate:value":a=>e.width=a,placeholder:"150px"},null,8,["value","onUpdate:value"])):i("",!0),"queryTypeEnum"===t.dataIndex?(u(),m(b,{key:4,onChange:a=>function(e,a){e===x.LIKE.value?a.columnNameList=[]:a.columnNameList=null}(a,e),enumName:"CODE_QUERY_FIELD_QUERY_TYPE_ENUM",value:e.queryTypeEnum,"onUpdate:value":a=>e.queryTypeEnum=a,width:"100%"},null,8,["onChange","value","onUpdate:value"])):i("",!0),"columnNameList"===t.dataIndex?(u(),m(T,{key:5,"show-search":"",mode:e.queryTypeEnum&&e.queryTypeEnum===r(x).LIKE.value?"multiple":"",value:e.columnNameList,"onUpdate:value":a=>e.columnNameList=a,onChange:a=>function(e){if(Array.isArray(e.columnNameList))return;let a=e.columnNameList,l=function(e,a){if(!e)return null;let l=e.filter((e=>e.columnName===a));return l&&l.length>0?l[0]:null}(L.value,a);e.fieldName=l&&l.columnName?g(l.columnName):"",e.label=l&&l.columnComment?g(l.columnComment):""}(e),style:{width:"100%"}},{default:s((()=>[(u(!0),n(c,null,p(L.value,(e=>(u(),m(U,{value:e.columnName,key:e.columnName},{default:s((()=>[d(v(e.columnName)+" ",1),y(f("span",null," （"+v(e.columnComment)+"） ",513),[[h,e.columnComment]])])),_:2},1032,["value"])))),128))])),_:2},1032,["mode","value","onUpdate:value","onChange"])):i("",!0),"operate"===t.dataIndex?(u(),n("div",_,[o(l,{type:"link",onClick:e=>function(e){const a=[...C.value];a.splice(e,1),C.value=[],N((()=>{C.value=a}))}(a),danger:""},{default:s((()=>[d("删除")])),_:2},1032,["onClick"])])):i("",!0)])),_:1},8,["dataSource","columns"])],64)}}});export{I as _};
