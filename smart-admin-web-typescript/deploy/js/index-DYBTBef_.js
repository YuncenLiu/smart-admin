import{_ as a}from"./lodash-2VbGH-WW.js";import{r as e}from"./role-api-CQ_zWWSq.js";import{s as t,a as s}from"./index-CBkxY9s9.js";import{b as o}from"./ant-design-vue-CcohkicM.js";import{d as i,i as p,r as l,w as r,e as d,b2 as u,z as c,b as n,o as m,ai as v,c as y,y as j,ag as f,bz as b,J as T,F as w,b0 as g,be as S,u as _}from"./@vue-BVvo-xZd.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";const h={class:"btn-group"},x={class:"data-container"},D=s(i({__name:"index",props:{value:Number},emits:["update:value"],setup(s){let i=p("selectRoleId"),D=l([]),I=l([]);async function k(){let a=await e.getDataScopeList();D.value=a.data,I.value=[],D.value.forEach((a=>{I.value.push({viewType:void 0,dataScopeType:a.dataScopeType})})),z()}async function z(){let a=(await e.getDataScopeByRoleId(i.value)).data;I.value=[],D.value.forEach((e=>{let t=a.find((a=>a.dataScopeType==e.dataScopeType));I.value.push({viewType:t?t.viewType:void 0,dataScopeType:e.dataScopeType})}))}async function E(){try{let t={roleId:i.value,dataScopeItemList:I.value.filter((e=>!a.isUndefined(e.viewType)))};await e.updateDataScope(t),o.success("保存成功"),k()}catch(s){t.captureError(s)}}return r((()=>i.value),(()=>z())),d(k),(a,e)=>{const t=u("a-button"),s=u("a-col"),o=u("a-row"),i=u("a-radio"),p=u("a-radio-group"),l=c("privilege");return m(),n("div",null,[v("div",h,[j((m(),f(t,{class:"button-style",type:"primary",onClick:E},{default:b((()=>[T(" 保存 ")])),_:1})),[[l,"system:role:dataScope:update"]]),y(t,{class:"button-style",onClick:k},{default:b((()=>[T(" 刷新 ")])),_:1})]),y(o,{class:"header"},{default:b((()=>[y(s,{class:"tab-margin",span:4},{default:b((()=>[T("业务单据")])),_:1}),y(s,{class:"tab-data",span:8},{default:b((()=>[T("查看数据范围")])),_:1}),y(s,{class:"tab-margin",span:12})])),_:1}),v("div",x,[(m(!0),n(w,null,g(_(D),((a,e)=>(m(),f(o,{class:"data",align:"middle",justify:"center",key:a.dataScopeType},{default:b((()=>[y(s,{class:"tab-margin",span:4},{default:b((()=>[T(S(a.dataScopeTypeName),1)])),_:2},1024),y(s,{class:"tab-data",span:8},{default:b((()=>[y(p,{value:_(I)[e].viewType,"onUpdate:value":a=>_(I)[e].viewType=a},{default:b((()=>[(m(!0),n(w,null,g(a.viewTypeList,(e=>(m(),f(i,{key:`${a.dataScopeType}-${e.viewType}`,class:"radio-style",value:e.viewType},{default:b((()=>[T(S(e.viewTypeName),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["value","onUpdate:value"])])),_:2},1024),y(s,{class:"tab-margin tab-desc",span:12},{default:b((()=>[v("p",null,S(a.dataScopeTypeDesc),1)])),_:2},1024)])),_:2},1024)))),128))])])}}}),[["__scopeId","data-v-ad274502"]]);export{D as default};
