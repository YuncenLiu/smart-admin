import{d as e,a,r as t,e as l,b2 as i,b as o,o as n,c as s,bz as u,J as r,ai as c,ag as d,ah as p,F as m,y as g,be as y,E as f,u as h}from"./@vue-BVvo-xZd.js";import{u as w}from"./vue-router-D-yLC68c.js";import{c as v,s as b,P as z}from"./index-CBkxY9s9.js";import{n as S}from"./notice-api-BS5_b2B9.js";const C=["onClick"],k=["onClick"],_=c("span",{style:{color:"red"}},"（未读）",-1),x={class:"smart-query-table-page"},I=e({__name:"notice-employee-list",setup(e){const I=a([{title:"标题",dataIndex:"title",ellipsis:!0},{title:"访问量",dataIndex:"pageViewCount",width:90},{title:"来源",dataIndex:"source",width:150,ellipsis:!0},{title:"作者",dataIndex:"author",width:80,ellipsis:!0},{title:"发布时间",dataIndex:"publishTime",width:150}]),q=t([]);const T={noticeTypeId:void 0,keywords:"",publishTimeBegin:null,publishTimeEnd:null,notViewFlag:!1,pageNum:1,pageSize:v},N=a({...T}),E=t([]),V=t(0),j=t(!1);function F(e){N.notViewFlag=0!==e||null,U()}async function O(){try{j.value=!0;const e=await S.queryEmployeeNotice(N);E.value=e.data.list,V.value=e.data.total}catch(e){b.captureError(e)}finally{j.value=!1}}function U(){N.pageNum=1,O()}function P(){Object.assign(N,T),B.value=[],A.value=[],O()}l((()=>{!async function(){try{const e=await S.getAllNoticeTypeList();q.value=e.data}catch(e){b.captureError(e)}}(),O()}));const B=t([]);function J(e,a){N.publishTimeBegin=a[0],N.publishTimeEnd=a[1]}const A=t([]),D=w();function K(e){D.push({path:"/oa/notice/notice-employee-detail",query:{noticeId:e}})}return(e,a)=>{const t=i("a-input"),l=i("a-form-item"),w=i("a-range-picker"),v=i("SearchOutlined"),b=i("a-button"),S=i("ReloadOutlined"),q=i("a-button-group"),T=i("a-row"),A=i("a-form"),D=i("a-tab-pane"),L=i("a-tabs"),Q=i("a-table"),R=i("a-pagination"),$=i("a-card");return n(),o(m,null,[s(A,{class:"smart-query-form"},{default:u((()=>[s(T,{class:"smart-query-form-row"},{default:u((()=>[s(l,{label:"关键字",class:"smart-query-form-item"},{default:u((()=>[s(t,{style:{width:"200px"},value:N.keywords,"onUpdate:value":a[0]||(a[0]=e=>N.keywords=e),placeholder:"标题、作者、来源、文号"},null,8,["value"])])),_:1}),s(l,{label:"发布时间",class:"smart-query-form-item"},{default:u((()=>[s(w,{value:B.value,"onUpdate:value":a[1]||(a[1]=e=>B.value=e),onChange:J,style:{width:"220px"}},null,8,["value"])])),_:1}),s(l,{class:"smart-query-form-item smart-margin-left10"},{default:u((()=>[s(q,null,{default:u((()=>[s(b,{type:"primary",onClick:U},{icon:u((()=>[s(v)])),default:u((()=>[r(" 查询 ")])),_:1}),s(b,{onClick:P},{icon:u((()=>[s(S)])),default:u((()=>[r(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1}),s(T,{class:"smart-query-form-row"})])),_:1}),s($,{size:"small",bordered:!1},{default:u((()=>[s(L,{onChange:F,size:"small"},{default:u((()=>[(n(),d(D,{key:0,tab:"全部"})),(n(),d(D,{key:1,tab:"未读"}))])),_:1}),s(Q,{rowKey:"noticeId",columns:I,dataSource:E.value,pagination:!1,loading:j.value,bordered:"",size:"small"},{bodyCell:u((({column:e,record:a,text:t})=>["title"===e.dataIndex?(n(),o(m,{key:0},[g(c("span",null,[c("a",{onClick:e=>K(a.noticeId),style:{color:"#8c8c8c"}},"【"+y(a.noticeTypeName)+"】"+y(t)+"（已读）",9,C)],512),[[f,a.viewFlag]]),g(c("span",null,[c("a",{onClick:e=>K(a.noticeId)},[r("【"+y(a.noticeTypeName)+"】"+y(t)+" ",1),_],8,k)],512),[[f,!a.viewFlag]])],64)):p("",!0),"pageViewCount"===e.dataIndex?(n(),o(m,{key:1},[r(y(a.userViewCount)+"人 / "+y(a.pageViewCount)+"次 ",1)],64)):p("",!0)])),_:1},8,["columns","dataSource","loading"]),c("div",x,[s(R,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:h(z),defaultPageSize:N.pageSize,current:N.pageNum,"onUpdate:current":a[2]||(a[2]=e=>N.pageNum=e),pageSize:N.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>N.pageSize=e),total:V.value,onChange:O,onShowSizeChange:O,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"])])])),_:1})],64)}}});export{I as _};
