import{m as e}from"./ant-design-vue-CcohkicM.js";import{d as a}from"./department-api-Dth9G_6l.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang-Ca0kUvG5.js";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang-CcaTzEf2.js";import{S as n,s as l}from"./index-CBkxY9s9.js";import{d as s,r as o,n as d,a as u,b2 as i,ag as m,o as p,bz as f,c,u as v,ah as h}from"./@vue-BVvo-xZd.js";const _=s({__name:"department-form-modal",emits:["refresh"],setup(s,{expose:_,emit:g}){_({showModal:function(e){I.value=!0,function(e){Object.assign(k,x),e&&Object.assign(k,e);I.value=!0}(e),d((()=>{const e=document.getElementsByClassName("ant-modal");e&&e.length>0&&Array.from(e).forEach((e=>{e.childNodes&&e.childNodes.length>0&&Array.from(e.childNodes).forEach((e=>{e.setAttribute&&e.setAttribute("aria-hidden","false")}))}))}))}});const y=g,I=o(!1);function b(){I.value=!1,Object.assign(k,x)}const w=o(),j=o(),x={id:void 0,managerId:void 0,name:void 0,parentId:void 0,sort:0},E=o();let k=u({...x});const O={parentId:[{required:!0,message:"上级部门不能为空"}],name:[{required:!0,message:"部门名称不能为空"},{max:50,message:"部门名称不能大于20个字符",trigger:"blur"}]};async function U(){try{await w.value.validate(),k.departmentId?async function(){n.show();try{if(k.parentId==k.departmentId)return void e.warning("上级菜单不能为自己");await a.updateDepartment(k),y("refresh"),b()}catch(t){l.captureError(t)}finally{n.hide()}}():async function(){n.show();try{await a.addDepartment(k),y("refresh"),b()}catch(e){l.captureError(e)}finally{n.hide()}}()}catch(t){e.error("参数验证错误，请仔细填写表单数据!")}}return(e,a)=>{const n=i("a-form-item"),l=i("a-input"),s=i("a-input-number"),o=i("a-form"),d=i("a-modal");return p(),m(d,{open:I.value,"onUpdate:open":a[4]||(a[4]=e=>I.value=e),title:v(k).departmentId?"编辑部门":"添加部门",onOk:U,destroyOnClose:""},{default:f((()=>[c(o,{ref_key:"formRef",ref:w,model:v(k),rules:O,layout:"vertical"},{default:f((()=>[0!=v(k).parentId?(p(),m(n,{key:0,label:"上级部门",name:"parentId"},{default:f((()=>[c(t,{ref_key:"departmentTreeSelect",ref:j,value:v(k).parentId,"onUpdate:value":a[0]||(a[0]=e=>v(k).parentId=e),defaultValueFlag:!1,width:"100%"},null,8,["value"])])),_:1})):h("",!0),c(n,{label:"部门名称",name:"name"},{default:f((()=>[c(l,{value:v(k).name,"onUpdate:value":a[1]||(a[1]=e=>v(k).name=e),valueModifiers:{trim:!0},placeholder:"请输入部门名称"},null,8,["value"])])),_:1}),c(n,{label:"部门负责人",name:"managerId"},{default:f((()=>[c(r,{ref_key:"employeeSelect",ref:E,placeholder:"请选择部门负责人",width:"100%",value:v(k).managerId,"onUpdate:value":a[2]||(a[2]=e=>v(k).managerId=e),leaveFlag:!1},null,8,["value"])])),_:1}),c(n,{label:"部门排序 （值越大越靠前！）",name:"sort"},{default:f((()=>[c(s,{style:{width:"100%"},value:v(k).sort,"onUpdate:value":a[3]||(a[3]=e=>v(k).sort=e),min:0,placeholder:"请输入部门排序"},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["open","title"])}}});export{_};
