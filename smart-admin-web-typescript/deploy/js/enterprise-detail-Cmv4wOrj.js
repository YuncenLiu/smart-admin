import{_ as e}from"./lodash-2VbGH-WW.js";import{a as t}from"./vue-router-D-yLC68c.js";import{_ as a}from"./enterprise-bank-list.vue_vue_type_script_setup_true_lang-C8FIX91l.js";import r from"./enterprise-employee-list-C4KT8Cm3.js";import{_ as i}from"./enterprise-invoice-list.vue_vue_type_script_setup_true_lang-CejJZaeQ.js";import l from"./enterprise-operate-modal-DexPMpQ2.js";import{e as s}from"./enterprise-api-COduTEQq.js";import{p as o,a as n,c as u,P as p,s as d,S as m}from"./index-CBkxY9s9.js";import{c}from"./diff-BE8ux7Aj.js";import{h as f}from"./diff2html-Cjc1Nsmf.js";import{u as _}from"./ua-parser-js-DNXwZhEt.js";import{d as v,b2 as y,ag as j,o as g,bz as b,b as h,F as w,b0 as S,ai as k,ah as N,be as I,a as z,r as L,w as O,c as E,J as q,u as C,n as x,e as T,m as A}from"./@vue-BVvo-xZd.js";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang-dcAvOOdY.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./enterprise-bank-operate-modal.vue_vue_type_script_setup_true_lang-CnElqlzj.js";import"./ant-design-vue-CcohkicM.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./dayjs-B6vKC6dp.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./index.vue_vue_type_script_setup_true_lang-CtW6JKpO.js";import"./sortablejs-CRp0PNdb.js";import"./table-id-const-DES3cCFe.js";import"./index.vue_vue_type_script_setup_true_lang-BqAwz9eM.js";import"./index.vue_vue_type_script_setup_true_lang-Ca0kUvG5.js";import"./department-api-Dth9G_6l.js";import"./enterprise-invoice-operate-modal.vue_vue_type_script_setup_true_lang-qcvmyMKI.js";import"./regular-const-vBMlR054.js";import"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./mitt-CNZ6avp8.js";import"./hogan.js-C2UNKCU2.js";const R=e=>o("/support/dataTracer/query",e),U={class:"trace-div"},$=["innerHTML"],M=["onClick"],P={class:"ip-font"},H=n(v({__name:"data-tracer-timeline",props:{tableData:{type:Array}},emits:["showDetail"],setup(e,{emit:t}){const a=t;return(t,r)=>{const i=y("a-timeline-item"),l=y("a-timeline");return g(),j(l,null,{default:b((()=>[(g(!0),h(w,null,S(e.tableData,(e=>(g(),j(i,{key:e.dataTracerId},{default:b((()=>[k("div",U,[k("div",null,[k("div",{class:"operate-content",innerHTML:e.content},null,8,$),e.diffOld||e.diffNew?(g(),h("a",{key:0,href:"javascript:void(0)",onClick:t=>function(e){a("showDetail",e)}(e)},"（查看修改）",8,M)):N("",!0)]),k("div",P,I(e.createTime)+" | "+I(e.userName)+" | "+I(e.ipRegion)+" | "+I(e.ip)+" | "+I(e.browser)+" | "+I(e.os),1)])])),_:2},1024)))),128))])),_:1})}}}),[["__scopeId","data-v-32d64c5b"]]),F=["innerHTML"],G=v({__name:"index",props:{dataId:{type:Number},type:{type:Number}},setup(e){let t=e;const a={pageNum:1,pageSize:u,searchCount:!0,keywords:void 0},r=z({...a}),i=L(!1),l=L([]),s=L(0);function o(){Object.assign(r,a),n()}function n(){r.pageNum=1,m()}async function m(){try{i.value=!0;let e=await R(Object.assign({},r,{dataId:t.dataId,type:t.type}));for(const t of e.data.list){if(!t.userAgent)continue;let e=_(t.userAgent);t.browser=e.browser.name,t.os=e.os.name,t.device=e.device.vendor?e.device.vendor+e.device.model:""}const a=e.data.list;s.value=e.data.total,l.value=a}catch(e){d.captureError(e)}finally{i.value=!1}}O((()=>t.dataId),(e=>{e&&(r.dataId=e,n())}),{immediate:!0});const v=L(!1);let j=L("");function S(e){v.value=!0;let t=e.diffOld.replaceAll("<br/>","\r\n"),a=e.diffNew.replaceAll("<br/>","\r\n");let r=c(...["",t,a,"变更前","变更后"]),i=f(r,{drawFileList:!1,matching:"words",diffMaxChanges:1e3,outputFormat:"side-by-side"});j.value=i,x((()=>{let e=document.querySelectorAll(".d2h-file-side-diff");if(e.length>0){let t=e[0],a=e[1];t.addEventListener("scroll",(function(e){t.scrollLeft!==a.scrollLeft&&(a.scrollLeft=t.scrollLeft)})),a.addEventListener("scroll",(function(e){t.scrollLeft!==a.scrollLeft&&(t.scrollLeft=a.scrollLeft)}))}}))}return(e,t)=>{const a=y("a-input"),i=y("a-form-item"),u=y("SearchOutlined"),d=y("a-button"),c=y("ReloadOutlined"),f=y("a-button-group"),_=y("a-row"),N=y("a-form"),I=y("a-pagination"),z=y("a-modal"),L=y("a-card");return g(),h(w,null,[E(N,{class:"smart-query-form"},{default:b((()=>[E(_,{class:"smart-query-form-row"},{default:b((()=>[E(i,{label:"关键字",class:"smart-query-form-item"},{default:b((()=>[E(a,{style:{width:"300px"},value:r.keywords,"onUpdate:value":t[0]||(t[0]=e=>r.keywords=e),placeholder:"变更内容"},null,8,["value"])])),_:1}),E(i,{class:"smart-query-form-item smart-margin-left10"},{default:b((()=>[E(f,null,{default:b((()=>[E(d,{type:"primary",onClick:n},{icon:b((()=>[E(u)])),default:b((()=>[q(" 查询 ")])),_:1}),E(d,{onClick:o},{icon:b((()=>[E(c)])),default:b((()=>[q(" 重置 ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),E(L,{size:"small",bordered:!1},{default:b((()=>[E(H,{tableData:l.value,onShowDetail:S},null,8,["tableData"]),E(I,{showSizeChanger:"",showQuickJumper:"","show-less-items":"",pageSizeOptions:C(p),defaultPageSize:r.pageSize,current:r.pageNum,"onUpdate:current":t[1]||(t[1]=e=>r.pageNum=e),pageSize:r.pageSize,"onUpdate:pageSize":t[2]||(t[2]=e=>r.pageSize=e),total:s.value,onChange:m,onShowSizeChange:m,"show-total":e=>`共${e}条`},null,8,["pageSizeOptions","defaultPageSize","current","pageSize","total","show-total"]),E(z,{open:v.value,"onUpdate:open":t[3]||(t[3]=e=>v.value=e),width:"90%",title:"数据比对",footer:null},{default:b((()=>[k("div",{innerHTML:C(j)},null,8,F)])),_:1},8,["open"])])),_:1})],64)}}}),J={GOODS:{value:1,desc:"商品"},OA_NOTICE:{value:2,desc:"OA-通知公告"},OA_ENTERPRISE:{value:3,desc:"OA-企业信息"}},Q={class:"detail-header"},W=n(v({__name:"enterprise-detail",setup(o){const n=t();let u=L();T((()=>{n.query.enterpriseId&&(u.value=Number(n.query.enterpriseId),_())}));const p=L();function c(){p.value.showModal(u.value)}let f=L({});async function _(){try{let e=await s.detail(u.value);f.value=e.data}catch(e){d.captureError(e)}finally{m.hide()}}const v=A((()=>{let e="";return f.value?(f.value.provinceName&&(e+=f.value.provinceName),f.value.cityName&&(e+=f.value.cityName),f.value.districtName&&(e+=f.value.districtName),e):e})),S=A((()=>f.value?e.isEmpty(f.value.enterpriseLogo)?"":f.value.enterpriseLogo[0].fileUrl:""));return(e,t)=>{const s=y("a-button"),o=y("a-descriptions-item"),n=y("a-descriptions"),d=y("a-page-header"),m=y("a-tab-pane"),z=y("a-tabs"),L=y("a-card");return g(),h(w,null,[k("div",Q,[E(d,{title:C(f).enterpriseName,avatar:{src:S.value}},{extra:b((()=>[E(s,{onClick:c,type:"primary"},{default:b((()=>[q("编辑")])),_:1})])),default:b((()=>[k("div",null,[E(n,{size:"small",column:3},{default:b((()=>[E(o,{label:"统一社会信用代码"},{default:b((()=>[q(I(C(f).unifiedSocialCreditCode),1)])),_:1}),E(o,{label:"联系人"},{default:b((()=>[q(I(C(f).contact),1)])),_:1}),E(o,{label:"联系人电话"},{default:b((()=>[q(I(C(f).contactPhone),1)])),_:1}),E(o,{label:"邮箱"},{default:b((()=>[q(I(C(f).email),1)])),_:1}),E(o,{label:"所在城市"},{default:b((()=>[q(I(v.value),1)])),_:1}),E(o,{label:"详细地址"},{default:b((()=>[q(I(C(f).address),1)])),_:1}),E(o,{label:"创建时间"},{default:b((()=>[q(I(C(f).createTime),1)])),_:1}),E(o,{label:"创建人"},{default:b((()=>[q(I(C(f).createUserName),1)])),_:1}),E(o,{label:"营业执照"},{default:b((()=>[E(D,{"file-list":C(f).businessLicense},null,8,["file-list"])])),_:1})])),_:1})])])),_:1},8,["title","avatar"])]),e.$privilege("oa:enterprise:queryEmployee")||e.$privilege("oa:bank:query")||e.$privilege("oa:invoice:query")?(g(),j(L,{key:0,class:"smart-margin-top10",size:"small"},{default:b((()=>[E(z,null,{default:b((()=>[e.$privilege("oa:enterprise:queryEmployee")?(g(),j(m,{key:"employee",tab:"员工信息"},{default:b((()=>[E(r,{enterpriseId:C(u)},null,8,["enterpriseId"])])),_:1})):N("",!0),e.$privilege("oa:bank:query")?(g(),j(m,{key:"bank",tab:"银行信息"},{default:b((()=>[E(a,{enterpriseId:C(u)},null,8,["enterpriseId"])])),_:1})):N("",!0),e.$privilege("oa:invoice:query")?(g(),j(m,{key:"invoice",tab:"发票信息"},{default:b((()=>[E(i,{enterpriseId:C(u)},null,8,["enterpriseId"])])),_:1})):N("",!0),E(m,{key:"dataTracer",tab:"变更记录"},{default:b((()=>[E(G,{dataId:C(u),type:C(J).OA_ENTERPRISE.value},null,8,["dataId","type"])])),_:1})])),_:1}),E(l,{ref_key:"operateRef",ref:p,onRefresh:_},null,512)])),_:1})):N("",!0)],64)}}}),[["__scopeId","data-v-82363f29"]]);export{W as default};
