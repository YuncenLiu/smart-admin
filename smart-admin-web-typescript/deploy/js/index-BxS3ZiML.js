import{_ as e}from"./lodash-2VbGH-WW.js";import{H as a,S as t,e as l,s as r,a as s}from"./index-CBkxY9s9.js";import{r as o}from"./role-api-CQ_zWWSq.js";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang-Ca0kUvG5.js";import{_ as d}from"./index.vue_vue_type_script_setup_true_lang-D394UfoC.js";import{_ as n}from"./index.vue_vue_type_script_setup_true_lang-xi4AYrGW.js";import{r as u}from"./regular-const-vBMlR054.js";import{b as m}from"./ant-design-vue-CcohkicM.js";import{d as p,r as c,a as v,b2 as f,ag as g,o as _,u as y,bz as j,c as b,ai as h,J as I,b as w,F as N,b0 as x,be as F,ah as U,n as q,aY as E,aW as k}from"./@vue-BVvo-xZd.js";import"./@ant-design-D2dl84QQ.js";import"./vue-Bbq_A2bw.js";import"./@ctrl-DlzbjsCp.js";import"./vue3-json-viewer-DGFKKWPN.js";import"./dayjs-B6vKC6dp.js";import"./vue-i18n-CEbWPeBD.js";import"./@intlify-D18cTrFw.js";import"./pinia-CgN6MZDh.js";import"./axios-BlN9Xwzv.js";import"./crypto-js-TV0Ce7JK.js";import"./sm-crypto-CWaozmhJ.js";import"./jsbn-DBh4-X7k.js";import"./nprogress-CqoNXQnd.js";import"./vue-router-D-yLC68c.js";import"./mitt-CNZ6avp8.js";import"./@babel-rSvM8Ko2.js";import"./resize-observer-polyfill-OVnto9HH.js";import"./@emotion-DXlYAqfy.js";import"./stylis-YutRQeBK.js";import"./vue-types-Sy1fKJ9U.js";import"./dom-align-CCb293uS.js";import"./lodash-es-BgZ_dRTG.js";import"./async-validator-BTKOuuO-.js";import"./throttle-debounce-w9OM8Bxz.js";import"./department-api-Dth9G_6l.js";import"./position-api-DKbDvSIj.js";const C=e=>(E("data-v-7dd5ba7d"),e=e(),k(),e),M=C((()=>h("br",null,null,-1))),D=C((()=>h("p",{class:"hint"},"初始密码默认为：随机",-1))),L={class:"footer"},O=s(p({__name:"index",emits:["refresh","show-account"],setup(s,{expose:p,emit:E}){const k=c(),C=E,O=c(!1);function z(){R(),O.value=!1}const A=c([]);const G=c(),B={employeeId:void 0,actualName:void 0,departmentId:void 0,disabledFlag:0,leaveFlag:0,gender:a.MAN.value,loginName:void 0,phone:void 0,roleIdList:void 0,positionId:void 0,email:void 0};let P=v(e.cloneDeep(B));function R(){Object.assign(P,B),G.value.resetFields()}const S={actualName:[{required:!0,message:"姓名不能为空"},{max:30,message:"姓名不能大于30个字符",trigger:"blur"}],phone:[{required:!0,message:"手机号不能为空"},{pattern:u.phone,message:"请输入正确的手机号码",trigger:"blur"}],loginName:[{required:!0,message:"登录账号不能为空"},{max:30,message:"登录账号不能大于30个字符",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空"}],departmentId:[{required:!0,message:"部门不能为空"}],disabledFlag:[{required:!0,message:"状态不能为空"}],leaveFlag:[{required:!0,message:"在职状态不能为空"}],email:[{required:!0,message:"请输入邮箱"}]};async function Y(e){var a;await(a=G.value,new Promise((e=>{a.validate().then((()=>{e(!0)})).catch((()=>{e(!1)}))})))?(t.show(),P.employeeId?await async function(e){try{await l.updateEmployee(P);m.success("更新成功"),e?R():z(),C("refresh")}catch(a){r.captureError(a)}finally{t.hide()}}(e):await async function(e){try{let{data:a}=await l.addEmployee(P);m.success("添加成功"),C("show-account",P.loginName,a),e?R():z(),C("refresh")}catch(a){r.captureError(a)}finally{t.hide()}}(e)):m.error("参数验证错误，请仔细填写表单数据!")}return p({showDrawer:async function(a){Object.assign(P,B),a&&!e.isEmpty(a)&&Object.assign(P,a),O.value=!0,q((()=>{!async function(){let e=await o.queryAll();A.value=e.data}()}))}}),(e,a)=>{const t=f("a-alert"),l=f("a-input"),r=f("a-form-item"),s=f("a-select-option"),o=f("a-select"),u=f("a-form"),m=f("a-button"),p=f("a-drawer");return _(),g(p,{title:y(P).employeeId?"编辑":"添加",width:600,open:O.value,"body-style":{paddingBottom:"80px"},onClose:z,destroyOnClose:""},{default:j((()=>[b(t,{message:"超管需要直接在数据库表 t_employee修改哦",type:"error",closable:""}),M,b(u,{ref_key:"formRef",ref:G,model:y(P),rules:S,layout:"vertical"},{default:j((()=>[b(r,{label:"姓名",name:"actualName"},{default:j((()=>[b(l,{value:y(P).actualName,"onUpdate:value":a[0]||(a[0]=e=>y(P).actualName=e),valueModifiers:{trim:!0},placeholder:"请输入姓名"},null,8,["value"])])),_:1}),b(r,{label:"手机号",name:"phone"},{default:j((()=>[b(l,{value:y(P).phone,"onUpdate:value":a[1]||(a[1]=e=>y(P).phone=e),valueModifiers:{trim:!0},placeholder:"请输入手机号"},null,8,["value"])])),_:1}),b(r,{label:"部门",name:"departmentId"},{default:j((()=>[b(i,{ref_key:"departmentTreeSelect",ref:k,width:"100%",init:!1,value:y(P).departmentId,"onUpdate:value":a[2]||(a[2]=e=>y(P).departmentId=e)},null,8,["value"])])),_:1}),b(r,{label:"登录名",name:"loginName"},{default:j((()=>[b(l,{value:y(P).loginName,"onUpdate:value":a[3]||(a[3]=e=>y(P).loginName=e),valueModifiers:{trim:!0},placeholder:"请输入登录名"},null,8,["value"]),D])),_:1}),b(r,{label:"邮箱",name:"email"},{default:j((()=>[b(l,{value:y(P).email,"onUpdate:value":a[4]||(a[4]=e=>y(P).email=e),valueModifiers:{trim:!0},placeholder:"请输入邮箱"},null,8,["value"])])),_:1}),b(r,{label:"性别",name:"gender"},{default:j((()=>[b(d,{style:{width:"100%"},value:y(P).gender,"onUpdate:value":a[5]||(a[5]=e=>y(P).gender=e),placeholder:"请选择性别","enum-name":"GENDER_ENUM"},null,8,["value"])])),_:1}),b(r,{label:"状态",name:"disabledFlag"},{default:j((()=>[b(o,{value:y(P).disabledFlag,"onUpdate:value":a[6]||(a[6]=e=>y(P).disabledFlag=e),placeholder:"请选择状态"},{default:j((()=>[b(s,{value:0},{default:j((()=>[I("启用")])),_:1}),b(s,{value:1},{default:j((()=>[I("禁用")])),_:1})])),_:1},8,["value"])])),_:1}),b(r,{label:"职务",name:"positionId"},{default:j((()=>[b(n,{value:y(P).positionId,"onUpdate:value":a[7]||(a[7]=e=>y(P).positionId=e),placeholder:"请选择职务"},null,8,["value"])])),_:1}),b(r,{label:"角色",name:"roleIdList"},{default:j((()=>[b(o,{mode:"multiple",value:y(P).roleIdList,"onUpdate:value":a[8]||(a[8]=e=>y(P).roleIdList=e),optionFilterProp:"title",placeholder:"请选择角色"},{default:j((()=>[(_(!0),w(N,null,x(A.value,(e=>(_(),g(s,{key:e.roleId,title:e.roleName},{default:j((()=>[I(F(e.roleName),1)])),_:2},1032,["title"])))),128))])),_:1},8,["value"])])),_:1})])),_:1},8,["model"]),h("div",L,[b(m,{style:{"margin-right":"8px"},onClick:z},{default:j((()=>[I("取消")])),_:1}),b(m,{type:"primary",style:{"margin-right":"8px"},onClick:a[9]||(a[9]=e=>Y(!1))},{default:j((()=>[I("保存")])),_:1}),y(P).employeeId?U("",!0):(_(),g(m,{key:0,type:"primary",onClick:a[10]||(a[10]=e=>Y(!0))},{default:j((()=>[I("保存并继续添加")])),_:1}))])])),_:1},8,["title","open"])}}}),[["__scopeId","data-v-7dd5ba7d"]]);export{O as default};
